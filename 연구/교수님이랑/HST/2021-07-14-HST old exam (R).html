<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.520">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="신록예찬">
<meta name="dcterms.date" content="2021-07-14">

<title>신록예찬’s Blog - (연구&amp;교수님) HST old exam (R)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">신록예찬’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DL2024/"> 
<span class="menu-text">DL2024</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/AP2023/"> 
<span class="menu-text">AP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/PP2024/"> 
<span class="menu-text">PP2024</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DV2023/"> 
<span class="menu-text">DV2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/MP2023/"> 
<span class="menu-text">MP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/SC2024/"> 
<span class="menu-text">SC2024</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DS2022/"> 
<span class="menu-text">DS2022</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/SP2023/"> 
<span class="menu-text">SP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/IR2021/"> 
<span class="menu-text">IR2021</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://miruetoto.github.io/yechan/"> 
<span class="menu-text">yechan</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://miruetoto.github.io/yechan2/"> 
<span class="menu-text">yechan2</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/miruetoto/yechan3"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">(연구&amp;교수님) HST old exam (R)</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../메모.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">메모</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../공부.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공부</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../연구.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">연구</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../자료.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">자료</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#response" id="toc-response" class="nav-link active" data-scroll-target="#response">Response</a></li>
  <li><a href="#간단한-구현예제" id="toc-간단한-구현예제" class="nav-link" data-scroll-target="#간단한-구현예제">간단한 구현예제</a>
  <ul class="collapse">
  <li><a href="#필요한-패키지-및-함수-정의" id="toc-필요한-패키지-및-함수-정의" class="nav-link" data-scroll-target="#필요한-패키지-및-함수-정의">필요한 패키지 및 함수 정의</a></li>
  <li><a href="#test-data" id="toc-test-data" class="nav-link" data-scroll-target="#test-data">TEST DATA</a></li>
  <li><a href="#hst-수행" id="toc-hst-수행" class="nav-link" data-scroll-target="#hst-수행">HST 수행</a></li>
  <li><a href="#결과-시각화-및-해석" id="toc-결과-시각화-및-해석" class="nav-link" data-scroll-target="#결과-시각화-및-해석">결과 시각화 및 해석</a></li>
  <li><a href="#결론" id="toc-결론" class="nav-link" data-scroll-target="#결론">결론</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2021-07-14-HST old exam (R).out.ipynb" download="2021-07-14-HST old exam (R).out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">(연구&amp;교수님) HST old exam (R)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>신록예찬 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 14, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="response" class="level2">
<h2 class="anchored" data-anchor-id="response">Response</h2>
<section id="첫번째-질문" class="level4">
<h4 class="anchored" data-anchor-id="첫번째-질문"><code>1</code> 첫번째 질문</h4>
<p>논문에서 Definition 6을 보면 Xi와 Xj 사이의 dissimilarity를 기댓값의 형태로 정의하게 되는데요. 정의에 의해 importance를 계산할 때도 기댓값을 구해야 가능하게 된다고 생각됩니다. 그런데 기댓값을 직접 계산하기 어려워 보이는 형태라서, 뒤에 simulated example이나 지하철 example에서 importance plot을 그릴 때에 importance를 어떻게 구하셨는지 궁금합니다.</p>
<blockquote class="blockquote">
<p>원래 목적은 아날래틱하게 평균을 계산하려 하였으나 그렇게 하지 못하고 sample mean으로 대체하였습니다. 즉 hst를 여러번 독립적으로 수행하여 <span class="math inline">\(\rho(\{Y_{i,\tau}\}_{\tau=0}^{T},\{Y_{j,\tau}\}_{\tau=0}^{T})\)</span> 를 구하고, 그것들의 sample mean으로 대체하였습니다.</p>
</blockquote>
<blockquote class="blockquote">
<p>사실 대부분 <span class="math inline">\(\rho(\{Y_{i,\tau}\}_{\tau=0}^{T},\{Y_{j,\tau}\}_{\tau=0}^{T})\)</span>의 값이 비슷하게 나와서 dissimilarity의 정의에서 기대값을 제외하여도 상관없을 것입니다. (저는 나중에 제외했어요)</p>
</blockquote>
</section>
<section id="두번째-질문" class="level4">
<h4 class="anchored" data-anchor-id="두번째-질문"><code>2</code> 두번째 질문</h4>
<p>4.3.1에서의 simulated example을 다루실 때 <code>b = 0.02*sqrt(V{Xi})</code>로 정의하셨는데, 이렇게 정하신 특별한 이유가 있을까요?</p>
<blockquote class="blockquote">
<p>없습니다.</p>
</blockquote>
<blockquote class="blockquote">
<p>현재는 제가 임의로 정한 고정값을 사용중입니다. b=0.06 이런식으로요. b의 값은 너무 크게 설정하지만 않으면 결과에 크게 민감하지 않습니다.</p>
</blockquote>
<p>또한, definition5에서 tau가 1씩 증가하면서 Y값을 얻어낼 때, snowdrift를 더함으로써 얻게 되는데, 이 과정에서 epsilon을 generate할 때 사용되는 b가 위에서의 값으로 고정인지, 아니면 tau-1일 때 얻은 Y들을 대상으로 0.02*sqrt(V{Yi})로 다시 update 하는 것인지 궁금합니다.</p>
<blockquote class="blockquote">
<p>고정입니다.</p>
</blockquote>
<p>(제가 example 4.1을 재현해보고 있는데 figure 4.4의 두번째 row에서 tau=10인 경우의 특징이었던 three straight lines가 보이지 않아서 b의 설정을 혹시 잘못한 것인지 궁금하여 여쭤봅니다.)</p>
<blockquote class="blockquote">
<p>참고하시라고 제가 예전에 구현했었던 코드를 뒤져서 복원해봤습니다. (포스트 뒤쪽에 확인할 수 있습니다) figure 4.4에 해당하는 코드는 아니고 다른 예제입니다. 아마 TEST DATA만 바꿔서 돌리시면 3개의 straight line이 비슷하게 나올겁니다.</p>
</blockquote>
</section>
<section id="세번째-질문" class="level4">
<h4 class="anchored" data-anchor-id="세번째-질문"><code>3</code> 세번째 질문</h4>
<p>4.3.2에서 지하철 데이터로 분석을 하실 때에 특정 시간, 특정 역에서 승차하는 사람 수를 Xi로 이해하였는데, 해당시간을 t, 해당 역을 서울대입구역이라고 한다면, (서울대입구역, t-1), (서울대입구역, t+1), (낙성대역, t), (봉천역, t) 이렇게 4 point들이 Xi와 linked 되어있다고 하고 HST를 진행하신 결과인가요?</p>
<blockquote class="blockquote">
<p>맞습니다.</p>
</blockquote>
<p>그 외에 Epsilon의 generation을 설정하기 위한 b값이나 pij 값이 지하철 예시의 경우에는 논문에서 찾기 어려워 어떻게 setting하고 분석을 진행하셨는지 궁금합니다.</p>
<blockquote class="blockquote">
<p><span class="math inline">\(p_{ij}\)</span>는 linked 된 노드들은 동일한 확률로 이동가능하다고 설정했습니다. 즉 4개의 point를 1/4의 확률로요.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(b\)</span>는 자세히 기억나지 않는데 <span class="math inline">\(b=2\)</span> 였던 것 같습니다. (즉 평균이 1이 되도록요) 제 생각에서는 <span class="math inline">\(\epsilon_k\)</span>를 굳이 유니폼에서 뽑지 않고 고정값 1로 사용하여도 거의 똑같은 결과가 나올것 같습니다. (실제로 요즘은 이렇게 하고 있어요)</p>
</blockquote>
</section>
<section id="기타" class="level4">
<h4 class="anchored" data-anchor-id="기타"><code>기타</code></h4>
<p>논문을 읽고 HST라는 multiscale method가 굉장히 재밌게 느껴져서 열심히 공부해보려고 합니다. 답변 주시면 정말 감사하겠습니다 교수님.</p>
<blockquote class="blockquote">
<p>재미있게 관심가져주셔서 감사합니다. 사실 제가 학위논문 작성할 당시에는 원시적인 아이디어 정도만 간단하게 서술하였습니다. 현재는 조금 다른 형태로 제가 나름대로 연구하고 있습니다. 최근에 작업중인 드래프트를 보내드릴 생각도 있어서 오희석교수님께 지금 작업중인 버전을 보여주는게 어떻겠냐고 여쭤봤었는데 교수님께서는 저와는 완전히 다른 학생만의 방식으로 논문을 다시 발전시키기를 원하시는것 같습니다. 그래서 일부러 원시형태의 논문을 읽어보라고 하셨던 것 같아요. <span class="math inline">\(\newline\)</span> 논문에 자세하게 서술하지는 못했지만 오희석 교수님께서는 눈이 쌓이는 모양이 재미있다고 생각하신 것 같습니다. 그 이유는 눈이 쌓인 정도에 따라서 우리가 보는 지형의 모양이 달라질 텐데 이것이 다양한 다중척도 방법과 관련이 있다고 여기신 것 같습니다. HST는 오희석 교수님의 직관을 제 나름대로 해석하여 구체화한 것이지 이러한 방식이 정답은 아닙니다. 학위논문 그대로의 방식보다 학생만의 방식으로 좀 더 색다르게 바꿔보는 것도 좋을것 같아요.</p>
</blockquote>
</section>
</section>
<section id="간단한-구현예제" class="level2">
<h2 class="anchored" data-anchor-id="간단한-구현예제">간단한 구현예제</h2>
<section id="필요한-패키지-및-함수-정의" class="level3">
<h3 class="anchored" data-anchor-id="필요한-패키지-및-함수-정의">필요한 패키지 및 함수 정의</h3>
<div id="819f5d07-70d3-4e9c-95f6-e69cc0c283c8" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-2"><a href="#cb1-2"></a>hst1d<span class="ot">&lt;-</span><span class="cf">function</span>(f,tau,<span class="at">b=</span><span class="fu">sd</span>(f)<span class="sc">*</span><span class="fl">0.01</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)) <span class="co"># prob=c(l,c,r)</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>{</span>
<span id="cb1-4"><a href="#cb1-4"></a>  lprob<span class="ot">&lt;-</span>prob[<span class="dv">1</span>]</span>
<span id="cb1-5"><a href="#cb1-5"></a>  cprob<span class="ot">&lt;-</span>prob[<span class="dv">2</span>]</span>
<span id="cb1-6"><a href="#cb1-6"></a>  rprob<span class="ot">&lt;-</span>prob[<span class="dv">3</span>]</span>
<span id="cb1-7"><a href="#cb1-7"></a>  len<span class="ot">&lt;-</span><span class="fu">length</span>(f)</span>
<span id="cb1-8"><a href="#cb1-8"></a>  hstresult<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,len<span class="sc">*</span>tau); <span class="fu">dim</span>(hstresult)<span class="ot">&lt;-</span><span class="fu">c</span>(len,tau)</span>
<span id="cb1-9"><a href="#cb1-9"></a>  hlen<span class="ot">&lt;-</span><span class="fu">round</span>(len<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>  oldf<span class="ot">&lt;-</span>f</span>
<span id="cb1-11"><a href="#cb1-11"></a>  f<span class="ot">&lt;-</span><span class="fu">c</span>(f[hlen<span class="sc">:</span><span class="dv">1</span>],f,f[len<span class="sc">:</span>(len<span class="sc">-</span>hlen<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb1-12"><a href="#cb1-12"></a>  </span>
<span id="cb1-13"><a href="#cb1-13"></a>  ls<span class="ot">&lt;-</span><span class="fu">landshape</span>(f)</span>
<span id="cb1-14"><a href="#cb1-14"></a>  f_before<span class="ot">&lt;-</span>f</span>
<span id="cb1-15"><a href="#cb1-15"></a>  f_after<span class="ot">&lt;-</span>f<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>  L<span class="ot">&lt;-</span><span class="fu">length</span>(f)</span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>tau)</span>
<span id="cb1-19"><a href="#cb1-19"></a>  {</span>
<span id="cb1-20"><a href="#cb1-20"></a>    minindex<span class="ot">&lt;-</span><span class="fu">which</span>(ls<span class="sc">==</span><span class="st">"minimum"</span>)</span>
<span id="cb1-21"><a href="#cb1-21"></a>    maxindex<span class="ot">&lt;-</span><span class="fu">which</span>(ls<span class="sc">==</span><span class="st">"maximum"</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a>    incindex<span class="ot">&lt;-</span><span class="fu">which</span>(ls<span class="sc">==</span><span class="st">"increasing"</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>    decindex<span class="ot">&lt;-</span><span class="fu">which</span>(ls<span class="sc">==</span><span class="st">"decreasing"</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a>    flatindex<span class="ot">&lt;-</span><span class="fu">which</span>(ls<span class="sc">==</span><span class="st">"flat"</span>)</span>
<span id="cb1-25"><a href="#cb1-25"></a>    epsilon<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span>b</span>
<span id="cb1-26"><a href="#cb1-26"></a>    f_after[minindex]<span class="ot">&lt;-</span>f_before[minindex]<span class="sc">+</span>epsilon<span class="sc">+</span>epsilon<span class="sc">*</span>lprob<span class="sc">+</span>epsilon<span class="sc">*</span>rprob</span>
<span id="cb1-27"><a href="#cb1-27"></a>    f_after[maxindex]<span class="ot">&lt;-</span>f_before[maxindex]<span class="sc">+</span>epsilon<span class="sc">*</span>cprob</span>
<span id="cb1-28"><a href="#cb1-28"></a>    f_after[incindex]<span class="ot">&lt;-</span>f_before[incindex]<span class="sc">+</span>epsilon<span class="sc">*</span>(cprob<span class="sc">+</span>rprob)<span class="sc">+</span>epsilon<span class="sc">*</span>(lprob)</span>
<span id="cb1-29"><a href="#cb1-29"></a>    f_after[decindex]<span class="ot">&lt;-</span>f_before[decindex]<span class="sc">+</span>epsilon<span class="sc">*</span>(cprob<span class="sc">+</span>lprob)<span class="sc">+</span>epsilon<span class="sc">*</span>(rprob)</span>
<span id="cb1-30"><a href="#cb1-30"></a>    f_after[flatindex]<span class="ot">&lt;-</span>f_before[flatindex]<span class="sc">+</span>epsilon<span class="sc">*</span>cprob<span class="sc">+</span>epsilon<span class="sc">*</span>rprob<span class="sc">*</span><span class="fl">0.5</span><span class="sc">+</span>epsilon<span class="sc">*</span>lprob<span class="sc">*</span><span class="fl">0.5</span></span>
<span id="cb1-31"><a href="#cb1-31"></a>    ls<span class="ot">&lt;-</span><span class="fu">landshape</span>(f_after)</span>
<span id="cb1-32"><a href="#cb1-32"></a>    f_before<span class="ot">&lt;-</span>f_after</span>
<span id="cb1-33"><a href="#cb1-33"></a>    hstresult[,i]<span class="ot">&lt;-</span>f_after[(hlen<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(L<span class="sc">-</span>hlen)]</span>
<span id="cb1-34"><a href="#cb1-34"></a>  }</span>
<span id="cb1-35"><a href="#cb1-35"></a>  <span class="fu">cbind</span>(oldf,hstresult)</span>
<span id="cb1-36"><a href="#cb1-36"></a>}</span>
<span id="cb1-37"><a href="#cb1-37"></a></span>
<span id="cb1-38"><a href="#cb1-38"></a>landshape<span class="ot">&lt;-</span><span class="cf">function</span>(f)</span>
<span id="cb1-39"><a href="#cb1-39"></a>{</span>
<span id="cb1-40"><a href="#cb1-40"></a>  len<span class="ot">&lt;-</span><span class="fu">length</span>(f)</span>
<span id="cb1-41"><a href="#cb1-41"></a>  ls<span class="ot">&lt;-</span>f<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb1-42"><a href="#cb1-42"></a>  ls[<span class="fu">c</span>(<span class="dv">1</span>,len)]<span class="ot">&lt;-</span><span class="st">"flat"</span></span>
<span id="cb1-43"><a href="#cb1-43"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(len<span class="dv">-1</span>))</span>
<span id="cb1-44"><a href="#cb1-44"></a>  {</span>
<span id="cb1-45"><a href="#cb1-45"></a>    <span class="cf">if</span>((f[i]<span class="sc">&gt;</span>f[i<span class="dv">-1</span>])<span class="sc">&amp;</span>(f[i]<span class="sc">&lt;</span>f[i<span class="sc">+</span><span class="dv">1</span>])) ls[i]<span class="ot">&lt;-</span><span class="st">"increasing"</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>    <span class="cf">else</span> <span class="cf">if</span>((f[i]<span class="sc">&lt;</span>f[i<span class="dv">-1</span>])<span class="sc">&amp;</span>(f[i]<span class="sc">&gt;</span>f[i<span class="sc">+</span><span class="dv">1</span>])) ls[i]<span class="ot">&lt;-</span><span class="st">"decreasing"</span></span>
<span id="cb1-47"><a href="#cb1-47"></a>    <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">mean</span>(<span class="fu">c</span>(f[i<span class="dv">-1</span>],f[i<span class="sc">+</span><span class="dv">1</span>]))<span class="sc">&lt;</span>f[i]) ls[i]<span class="ot">&lt;-</span><span class="st">"maximum"</span></span>
<span id="cb1-48"><a href="#cb1-48"></a>    <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">mean</span>(<span class="fu">c</span>(f[i<span class="dv">-1</span>],f[i<span class="sc">+</span><span class="dv">1</span>]))<span class="sc">&gt;</span>f[i]) ls[i]<span class="ot">&lt;-</span><span class="st">"minimum"</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>    <span class="cf">else</span> ls[i]<span class="ot">&lt;-</span><span class="st">"flat"</span></span>
<span id="cb1-50"><a href="#cb1-50"></a>  }</span>
<span id="cb1-51"><a href="#cb1-51"></a>  ls</span>
<span id="cb1-52"><a href="#cb1-52"></a>}</span>
<span id="cb1-53"><a href="#cb1-53"></a>    </span>
<span id="cb1-54"><a href="#cb1-54"></a>g_legend<span class="ot">&lt;-</span><span class="cf">function</span>(a.gplot){</span>
<span id="cb1-55"><a href="#cb1-55"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">ggplot_gtable</span>(<span class="fu">ggplot_build</span>(a.gplot))</span>
<span id="cb1-56"><a href="#cb1-56"></a>    leg <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(tmp<span class="sc">$</span>grobs, <span class="cf">function</span>(x) x<span class="sc">$</span>name) <span class="sc">==</span> <span class="st">"guide-box"</span>)</span>
<span id="cb1-57"><a href="#cb1-57"></a>    legend <span class="ot">&lt;-</span> tmp<span class="sc">$</span>grobs[[leg]]</span>
<span id="cb1-58"><a href="#cb1-58"></a>    <span class="fu">return</span>(legend)}</span>
<span id="cb1-59"><a href="#cb1-59"></a>      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test-data" class="level3">
<h3 class="anchored" data-anchor-id="test-data">TEST DATA</h3>
<p><code>-</code> 분석에 사용할 test data 입니다.</p>
<div id="b978c512-e0d0-4ec9-9928-7c4e4c61712f" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#collapse-hide</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>seq1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>);</span>
<span id="cb2-3"><a href="#cb2-3"></a>f1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(seq1,<span class="dv">33</span>),<span class="dv">1</span>);</span>
<span id="cb2-4"><a href="#cb2-4"></a>localstr<span class="ot">&lt;-</span><span class="fu">landshape</span>(f1)</span>
<span id="cb2-5"><a href="#cb2-5"></a>localstr[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"minimum"</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>localstr[<span class="dv">133</span>]<span class="ot">&lt;-</span><span class="st">"minimum"</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>f2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">23</span>,<span class="dv">22</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">23</span>,<span class="dv">22</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">23</span>,<span class="dv">22</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span> <span class="co"># trend </span></span>
<span id="cb2-8"><a href="#cb2-8"></a>globalstr<span class="ot">&lt;-</span><span class="fu">landshape</span>(f2)</span>
<span id="cb2-9"><a href="#cb2-9"></a>globalstr[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"minimum"</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>globalstr[<span class="dv">133</span>]<span class="ot">&lt;-</span><span class="st">"minimum"</span> </span>
<span id="cb2-11"><a href="#cb2-11"></a>f<span class="ot">&lt;-</span>f1<span class="sc">+</span>f2 </span>
<span id="cb2-12"><a href="#cb2-12"></a>f<span class="ot">&lt;-</span>f<span class="sc">+</span><span class="fu">rnorm</span>(<span class="fu">length</span>(f),<span class="dv">0</span>,<span class="at">sd=</span><span class="fl">0.1</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a>data_multiscalegrouping<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">localstr=</span>localstr,<span class="at">globalstr=</span>globalstr,<span class="at">f=</span>f)</span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="fu">ggplot</span>(data_multiscalegrouping, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f), <span class="at">y=</span>f,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-07-14-HST old exam (R)_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> 그림을 보면 아시겠지만 톱니모양으로 되어있습니다.</p>
<section id="global-view" class="level4">
<h4 class="anchored" data-anchor-id="global-view">Global view</h4>
<p><code>-</code> 1,45,89,133 의 관측치가 minimum 23,67,111번 관측치가 maximum 입니다.</p>
<p><code>-</code> 2,3,…,22 는 우상향 트렌드에 있고 24,25,…,44 는 우하향 트렌드에 있습니다.</p>
<p><code>-</code> 정리하면 아래그림과 같음</p>
<div id="b2ae1b99-4e5b-4f39-9db5-bcabb1b025f4" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#collapse-hide</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">ggplot</span>(data_multiscalegrouping, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f), <span class="at">y=</span>f,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_line</span>()<span class="sc">+</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f), <span class="at">y=</span>f, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-07-14-HST old exam (R)_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="local-view" class="level4">
<h4 class="anchored" data-anchor-id="local-view">Local view</h4>
<p><code>-</code> 3,7, 과 같은 관측치도 maximum으로 분류할 수 있습니다.</p>
<p><code>-</code> 정리해보면 아래와 같음</p>
<div id="b858dea4-0b26-41de-9303-2786c0337aec" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#collapse-hide</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">ggplot</span>(data_multiscalegrouping, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f), <span class="at">y=</span>f,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f), <span class="at">y=</span>f, <span class="at">colour=</span>localstr),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Local Structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-07-14-HST old exam (R)_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="hst-수행" class="level3">
<h3 class="anchored" data-anchor-id="hst-수행">HST 수행</h3>
<section id="hst를-하는-목적" class="level4">
<h4 class="anchored" data-anchor-id="hst를-하는-목적">HST를 하는 목적</h4>
<p><code>-</code> 특정자료는 좀더 미시적인 관점에서 보느냐, 아니면 거시적인 관점에서 보느냐에 따라서 해석이 달라짐</p>
<p><code>-</code> 예를들어 3,7,11 등과 같은 자료는 적은 연결 (극단적으로 본인자신과 좌우1개씩) 만을 고려하면 극대점으로 해석할 수 있으나 좀더 많은 연결을 고려하면 그렇지 않음</p>
<p><code>-</code> <span class="math inline">\(\tau\)</span>가 작을때는 local 한 관점에서의 structure가, <span class="math inline">\(\tau\)</span>가 클때는 global한 structure가 보였으면 좋겠음</p>
</section>
<section id="hst-수행-1" class="level4">
<h4 class="anchored" data-anchor-id="hst-수행-1">HST 수행</h4>
<div id="48d6088e-0c96-4fb2-a170-f65ee78cb841" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>hst1d_rslt<span class="ot">&lt;-</span><span class="fu">hst1d</span>(f,<span class="at">b=</span><span class="fu">sd</span>(f)<span class="sc">*</span><span class="fl">0.05</span>,<span class="at">tau=</span><span class="dv">130</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hst-to-pca" class="level4">
<h4 class="anchored" data-anchor-id="hst-to-pca">HST <span class="math inline">\(\to\)</span> PCA</h4>
<p><code>-</code> <span class="math inline">\(\tau=5,15,30,60,120\)</span></p>
<div id="4981e245-3b52-4fa3-a652-5028dca96940" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="do">### hst result</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>PC5<span class="ot">&lt;-</span><span class="fu">princomp</span>(hst1d_rslt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb6-3"><a href="#cb6-3"></a>PC5plotdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">PC1=</span>PC5<span class="sc">$</span>score[,<span class="dv">1</span>],<span class="at">PC2=</span>PC5<span class="sc">$</span>score[,<span class="dv">2</span>],</span>
<span id="cb6-4"><a href="#cb6-4"></a>                      <span class="at">localstr=</span>localstr,<span class="at">globalstr=</span>globalstr)</span>
<span id="cb6-5"><a href="#cb6-5"></a>  </span>
<span id="cb6-6"><a href="#cb6-6"></a>PC15<span class="ot">&lt;-</span><span class="fu">princomp</span>(hst1d_rslt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span>
<span id="cb6-7"><a href="#cb6-7"></a>PC15plotdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">PC1=</span>PC15<span class="sc">$</span>score[,<span class="dv">1</span>],<span class="at">PC2=</span>PC15<span class="sc">$</span>score[,<span class="dv">2</span>],</span>
<span id="cb6-8"><a href="#cb6-8"></a>                       <span class="at">localstr=</span>localstr,<span class="at">globalstr=</span>globalstr)</span>
<span id="cb6-9"><a href="#cb6-9"></a>  </span>
<span id="cb6-10"><a href="#cb6-10"></a>PC30<span class="ot">&lt;-</span><span class="fu">princomp</span>(hst1d_rslt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>])</span>
<span id="cb6-11"><a href="#cb6-11"></a>PC30plotdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">PC1=</span>PC30<span class="sc">$</span>score[,<span class="dv">1</span>],<span class="at">PC2=</span>PC30<span class="sc">$</span>score[,<span class="dv">2</span>],</span>
<span id="cb6-12"><a href="#cb6-12"></a>                       <span class="at">localstr=</span>localstr,<span class="at">globalstr=</span>globalstr)        </span>
<span id="cb6-13"><a href="#cb6-13"></a>  </span>
<span id="cb6-14"><a href="#cb6-14"></a>PC60<span class="ot">&lt;-</span><span class="fu">princomp</span>(hst1d_rslt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>])</span>
<span id="cb6-15"><a href="#cb6-15"></a>PC60plotdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">PC1=</span>PC60<span class="sc">$</span>score[,<span class="dv">1</span>],<span class="at">PC2=</span>PC60<span class="sc">$</span>score[,<span class="dv">2</span>],</span>
<span id="cb6-16"><a href="#cb6-16"></a>                       <span class="at">localstr=</span>localstr,<span class="at">globalstr=</span>globalstr)</span>
<span id="cb6-17"><a href="#cb6-17"></a>  </span>
<span id="cb6-18"><a href="#cb6-18"></a>PC90<span class="ot">&lt;-</span><span class="fu">princomp</span>(hst1d_rslt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">90</span>])</span>
<span id="cb6-19"><a href="#cb6-19"></a>PC90plotdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">PC1=</span>PC90<span class="sc">$</span>score[,<span class="dv">1</span>],<span class="at">PC2=</span>PC90<span class="sc">$</span>score[,<span class="dv">2</span>],</span>
<span id="cb6-20"><a href="#cb6-20"></a>                       <span class="at">localstr=</span>localstr,<span class="at">globalstr=</span>globalstr)</span>
<span id="cb6-21"><a href="#cb6-21"></a>  </span>
<span id="cb6-22"><a href="#cb6-22"></a>PC120<span class="ot">&lt;-</span><span class="fu">princomp</span>(hst1d_rslt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">120</span>])</span>
<span id="cb6-23"><a href="#cb6-23"></a>PC120plotdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">PC1=</span>PC120<span class="sc">$</span>score[,<span class="dv">1</span>],<span class="at">PC2=</span>PC120<span class="sc">$</span>score[,<span class="dv">2</span>],</span>
<span id="cb6-24"><a href="#cb6-24"></a>                        <span class="at">localstr=</span>localstr,<span class="at">globalstr=</span>globalstr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="결과-시각화-및-해석" class="level3">
<h3 class="anchored" data-anchor-id="결과-시각화-및-해석">결과 시각화 및 해석</h3>
<section id="global-view-1" class="level4">
<h4 class="anchored" data-anchor-id="global-view-1">global view</h4>
<div id="f627b624-996d-46cc-a5f3-4db251224b7f" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">#collapse-hide</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">ggplot</span>(data_multiscalegrouping, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f), <span class="at">y=</span>f,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_line</span>()<span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f), <span class="at">y=</span>f, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-07-14-HST old exam (R)_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="af871089-3cce-422e-9f59-d89405ed7fd9" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#collapse-hide</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>global5<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC5plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)<span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">5</span>)))<span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb8-11"><a href="#cb8-11"></a>  </span>
<span id="cb8-12"><a href="#cb8-12"></a>global15<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC15plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)<span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">15</span>)))<span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb8-21"><a href="#cb8-21"></a>  </span>
<span id="cb8-22"><a href="#cb8-22"></a>global30<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC30plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)<span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">30</span>)))<span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb8-31"><a href="#cb8-31"></a>  </span>
<span id="cb8-32"><a href="#cb8-32"></a>global60<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC60plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)<span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">60</span>)))<span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb8-41"><a href="#cb8-41"></a>  </span>
<span id="cb8-42"><a href="#cb8-42"></a>  </span>
<span id="cb8-43"><a href="#cb8-43"></a>global90<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC90plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb8-45"><a href="#cb8-45"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb8-47"><a href="#cb8-47"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb8-48"><a href="#cb8-48"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)<span class="sc">+</span></span>
<span id="cb8-49"><a href="#cb8-49"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">90</span>)))<span class="sc">+</span></span>
<span id="cb8-50"><a href="#cb8-50"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb8-51"><a href="#cb8-51"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb8-52"><a href="#cb8-52"></a>  </span>
<span id="cb8-53"><a href="#cb8-53"></a>global120<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC120plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-54"><a href="#cb8-54"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>globalstr),<span class="at">size=</span><span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb8-55"><a href="#cb8-55"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb8-56"><a href="#cb8-56"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb8-57"><a href="#cb8-57"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb8-58"><a href="#cb8-58"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Global Structure"</span>)<span class="sc">+</span></span>
<span id="cb8-59"><a href="#cb8-59"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">120</span>)))<span class="sc">+</span></span>
<span id="cb8-60"><a href="#cb8-60"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb8-61"><a href="#cb8-61"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb8-62"><a href="#cb8-62"></a>globallegend<span class="ot">&lt;-</span><span class="fu">g_legend</span>(global5<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>))</span>
<span id="cb8-63"><a href="#cb8-63"></a>global<span class="ot">&lt;-</span><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(global5 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb8-64"><a href="#cb8-64"></a>                            global15 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb8-65"><a href="#cb8-65"></a>                            global30 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb8-66"><a href="#cb8-66"></a>                            global60 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb8-67"><a href="#cb8-67"></a>                            global90 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb8-68"><a href="#cb8-68"></a>                            global120 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb8-69"><a href="#cb8-69"></a>                            <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>),</span>
<span id="cb8-70"><a href="#cb8-70"></a>                            globallegend, <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">heights=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-07-14-HST old exam (R)_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> <span class="math inline">\(\tau=120\)</span>에서의 결과가 global view에서의 자료구조를 잘 파악함. - 1,45,89,133이 거시적인 관점에서 보면 valley 인데 이러한 점들이 잘 구분되어 있음 (보라색) - 23,67,111과 같은 peaks 역시 잘 드러남 (파란색)</p>
</section>
<section id="local-view-1" class="level4">
<h4 class="anchored" data-anchor-id="local-view-1">local view</h4>
<p><code>-</code> 동일한 자료를 local view로 본다면 작은 <span class="math inline">\(\tau\)</span>가 해석에 용이함</p>
<div id="25d02e86-cebe-4d3d-9b66-7ba7932d58cd" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#collapse-hide</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb9-3"><a href="#cb9-3"></a>local5<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC5plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>localstr),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Local Structure"</span>)<span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">5</span>)))<span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb9-12"><a href="#cb9-12"></a>  </span>
<span id="cb9-13"><a href="#cb9-13"></a>local15<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC15plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>localstr),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Local Structure"</span>)<span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">15</span>)))<span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb9-22"><a href="#cb9-22"></a>  </span>
<span id="cb9-23"><a href="#cb9-23"></a>local30<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC30plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>localstr),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Local Structure"</span>)<span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">30</span>)))<span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb9-32"><a href="#cb9-32"></a>  </span>
<span id="cb9-33"><a href="#cb9-33"></a></span>
<span id="cb9-34"><a href="#cb9-34"></a>local60<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC60plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>localstr),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-37"><a href="#cb9-37"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb9-38"><a href="#cb9-38"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb9-39"><a href="#cb9-39"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Local Structure"</span>)<span class="sc">+</span></span>
<span id="cb9-40"><a href="#cb9-40"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">60</span>)))<span class="sc">+</span></span>
<span id="cb9-41"><a href="#cb9-41"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb9-42"><a href="#cb9-42"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb9-43"><a href="#cb9-43"></a></span>
<span id="cb9-44"><a href="#cb9-44"></a>  </span>
<span id="cb9-45"><a href="#cb9-45"></a>local90<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC90plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb9-46"><a href="#cb9-46"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>localstr),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb9-47"><a href="#cb9-47"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-48"><a href="#cb9-48"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb9-49"><a href="#cb9-49"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb9-50"><a href="#cb9-50"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Local Structure"</span>)<span class="sc">+</span></span>
<span id="cb9-51"><a href="#cb9-51"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">90</span>)))<span class="sc">+</span></span>
<span id="cb9-52"><a href="#cb9-52"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb9-53"><a href="#cb9-53"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb9-54"><a href="#cb9-54"></a></span>
<span id="cb9-55"><a href="#cb9-55"></a>local120<span class="ot">&lt;-</span><span class="fu">ggplot</span>(PC120plotdf, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2,<span class="at">label=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">133</span>))<span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb9-56"><a href="#cb9-56"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">colour=</span>localstr),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb9-57"><a href="#cb9-57"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-58"><a href="#cb9-58"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),<span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"Black"</span>))<span class="sc">+</span></span>
<span id="cb9-59"><a href="#cb9-59"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb9-60"><a href="#cb9-60"></a>    <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Local Structure"</span>)<span class="sc">+</span></span>
<span id="cb9-61"><a href="#cb9-61"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(tau,<span class="st">"="</span>,<span class="dv">120</span>)))<span class="sc">+</span></span>
<span id="cb9-62"><a href="#cb9-62"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>),<span class="at">lineheight=</span><span class="fl">0.9</span>,<span class="at">face=</span><span class="st">"bold.italic"</span>,<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb9-63"><a href="#cb9-63"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="st">"mm"</span>))</span>
<span id="cb9-64"><a href="#cb9-64"></a></span>
<span id="cb9-65"><a href="#cb9-65"></a>locallegend<span class="ot">&lt;-</span><span class="fu">g_legend</span>(local5<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>))</span>
<span id="cb9-66"><a href="#cb9-66"></a> </span>
<span id="cb9-67"><a href="#cb9-67"></a>local<span class="ot">&lt;-</span><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(local5 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb9-68"><a href="#cb9-68"></a>                           local15 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb9-69"><a href="#cb9-69"></a>                           local30 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb9-70"><a href="#cb9-70"></a>                           local60 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb9-71"><a href="#cb9-71"></a>                           local90 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb9-72"><a href="#cb9-72"></a>                           local120 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>),</span>
<span id="cb9-73"><a href="#cb9-73"></a>                           <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>),</span>
<span id="cb9-74"><a href="#cb9-74"></a>                           locallegend, <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">heights=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-07-14-HST old exam (R)_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> <span class="math inline">\(\tau=5\)</span> 일때가 재미있음. pc2에 의해서 점들은 3개의 그룹으로 나누어짐. - minimum (보라색) - maximum (파란색) - incresing <span class="math inline">\(\cup\)</span> decreasing (초록색, 빨간색)</p>
<p><code>-</code> <span class="math inline">\(\tau\)</span>가 커질수록 이러한 구분은 무의미함</p>
</section>
</section>
<section id="결론" class="level3">
<h3 class="anchored" data-anchor-id="결론">결론</h3>
<p><code>-</code> 작은 <span class="math inline">\(\tau\)</span>는 자료를 local view로 보았을 경우 특징을 잡아낸다. 반면에 큰 <span class="math inline">\(\tau\)</span>는 자료를 global view로 보았을 경우 특징을 잡아냄</p>
<p><code>-</code> 이 예제를 파이썬으로 구현한것은 아래에 있음.</p>
<p>https://miruetoto.github.io/yechan/%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC/2021/07/14/(%EC%97%B0%EA%B5%AC)-HST-old-example-(Python)-%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC.html</p>
<ul>
<li>HST의 정의가 R에서 구현한 방식과 아주 조금 다르긴한데 (요즘 제가 정의를 자주 바꾸고 있어서요) 거의 비슷한 효과가 나오도록 제가 파라메터를 조정했습니다.</li>
<li>바뀐 정의의 특성상 낮은 <span class="math inline">\(\tau\)</span>에서 관찰가능한 선명한 3개의 직선은 나오지 않지만 어느정도 비슷한 결론을 줍니다.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="miruetoto/yechan3" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>