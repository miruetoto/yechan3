<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.520">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="신록예찬">
<meta name="dcterms.date" content="2021-08-15">

<title>신록예찬’s Blog - (연구&amp;교수님) HST example 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">신록예찬’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DL2024/"> 
<span class="menu-text">DL2024</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/AP2023/"> 
<span class="menu-text">AP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/PP2024/"> 
<span class="menu-text">PP2024</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DV2023/"> 
<span class="menu-text">DV2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/MP2023/"> 
<span class="menu-text">MP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/SC2024/"> 
<span class="menu-text">SC2024</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DS2022/"> 
<span class="menu-text">DS2022</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/SP2023/"> 
<span class="menu-text">SP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/IR2021/"> 
<span class="menu-text">IR2021</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://miruetoto.github.io/yechan/"> 
<span class="menu-text">yechan</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://miruetoto.github.io/yechan2/"> 
<span class="menu-text">yechan2</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/miruetoto/yechan3"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">(연구&amp;교수님) HST example 3</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../메모.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">메모</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../공부.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공부</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../연구.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">연구</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../자료.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">자료</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">import</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">load data</a></li>
  <li><a href="#hst" id="toc-hst" class="nav-link" data-scroll-target="#hst">HST</a></li>
  <li><a href="#r-환경으로.." id="toc-r-환경으로.." class="nav-link" data-scroll-target="#r-환경으로..">R 환경으로..</a></li>
  <li><a href="#유클리드와-그래프도메인의-정보를-플랏." id="toc-유클리드와-그래프도메인의-정보를-플랏." class="nav-link" data-scroll-target="#유클리드와-그래프도메인의-정보를-플랏.">유클리드와 그래프도메인의 정보를 플랏.</a></li>
  <li><a href="#gfft-수행하고-결과를-저장함." id="toc-gfft-수행하고-결과를-저장함." class="nav-link" data-scroll-target="#gfft-수행하고-결과를-저장함.">gfft 수행하고 결과를 저장함.</a></li>
  <li><a href="#아이겐플랏" id="toc-아이겐플랏" class="nav-link" data-scroll-target="#아이겐플랏">아이겐플랏</a></li>
  <li><a href="#분해" id="toc-분해" class="nav-link" data-scroll-target="#분해">분해</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2021-08-15-HST example 3.out.ipynb" download="2021-08-15-HST example 3.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">(연구&amp;교수님) HST example 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>신록예찬 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 15, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="import" class="level3">
<h3 class="anchored" data-anchor-id="import">import</h3>
<div id="cell-2" class="cell" data-execution_count="683">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">## 1. remove trash</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">!</span>rm <span class="op">-</span>rf <span class="op">~/</span>.local<span class="op">/</span>share<span class="op">/</span>Trash<span class="op">/</span>files<span class="op">/*</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-7"><a href="#cb1-7"></a>matplotlib.rc(<span class="st">'image'</span>, cmap<span class="op">=</span><span class="st">'Greys'</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">import</span> rpy2 </span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="op">%</span>load_ext rpy2.ipython</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="op">%</span>run pybase</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="op">%</span>run heavysnow </span>
<span id="cb1-12"><a href="#cb1-12"></a>plt.style.use(<span class="st">'ggplot'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The rpy2.ipython extension is already loaded. To reload it, use:
  %reload_ext rpy2.ipython</code></pre>
</div>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">load data</h3>
<div id="cell-4" class="cell" data-execution_count="861">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>n<span class="op">=</span><span class="dv">23</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>f<span class="op">=</span>np.array(pd.read_csv(<span class="st">"2021-08-15-MCU-ticket.csv"</span>).Worldwide)<span class="op">/</span><span class="dv">1000000</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>V<span class="op">=</span>np.array(pd.read_csv(<span class="st">"2021-08-15-MCU-ticket.csv"</span>).Film)</span>
<span id="cb3-4"><a href="#cb3-4"></a>W<span class="op">=</span>np.array(pd.read_csv(<span class="st">"2021-08-15-MCU-weights.csv"</span>,index_col<span class="op">=</span><span class="dv">0</span>))<span class="op">-</span>np.eye(n,n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hst" class="level3">
<h3 class="anchored" data-anchor-id="hst">HST</h3>
<div id="cell-6" class="cell" data-execution_count="1132">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>gs<span class="op">=</span>GraphSignal(V,W,f)</span>
<span id="cb4-2"><a href="#cb4-2"></a>hst<span class="op">=</span>HeavysnowTransform(gs)</span>
<span id="cb4-3"><a href="#cb4-3"></a>hst.snow(tau<span class="op">=</span><span class="dv">40000</span>,b<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>HST (tau= 40000, b=1)
40000/40000
HST completed and all history is recorded.</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="1186">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>hst.adjustingtheta(<span class="dv">140</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell" data-execution_count="1187">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>plt.imshow(hst.snowweight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-환경으로.." class="level3">
<h3 class="anchored" data-anchor-id="r-환경으로..">R 환경으로..</h3>
<div id="cell-10" class="cell" data-execution_count="1188">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> rpy2 </span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="op">%</span>load_ext rpy2.ipython</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The rpy2.ipython extension is already loaded. To reload it, use:
  %reload_ext rpy2.ipython</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="1189">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>n<span class="op">=</span>hst.n </span>
<span id="cb10-2"><a href="#cb10-2"></a>V<span class="op">=</span>hst.V</span>
<span id="cb10-3"><a href="#cb10-3"></a>f<span class="op">=</span>hst.f </span>
<span id="cb10-4"><a href="#cb10-4"></a>WEuclid<span class="op">=</span> hst.euclidweight</span>
<span id="cb10-5"><a href="#cb10-5"></a>Wgraph<span class="op">=</span> (hst.graphweight<span class="op">+</span>hst.graphweight.T)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>Whst<span class="op">=</span> hst.snowweight</span>
<span id="cb10-7"><a href="#cb10-7"></a>W<span class="op">=</span> hst.graphweight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-12" class="cell" data-execution_count="1190">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="op">%</span>R <span class="op">-</span>i n</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="op">%</span>R <span class="op">-</span>i V</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="op">%</span>R <span class="op">-</span>i f</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="op">%</span>R <span class="op">-</span>i WEuclid</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="op">%</span>R <span class="op">-</span>i Wgraph</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="op">%</span>R <span class="op">-</span>i Whst</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="op">%</span>R <span class="op">-</span>i W</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="유클리드와-그래프도메인의-정보를-플랏." class="level3">
<h3 class="anchored" data-anchor-id="유클리드와-그래프도메인의-정보를-플랏.">유클리드와 그래프도메인의 정보를 플랏.</h3>
<div id="cell-14" class="cell" data-execution_count="1191">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">150</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">660</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>source(<span class="st">'heavysnow.R'</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>dat_<span class="op">&lt;-</span>tibble(V)</span>
<span id="cb12-4"><a href="#cb12-4"></a>dat_$f<span class="op">&lt;-</span><span class="im">as</span>.vector(f)</span>
<span id="cb12-5"><a href="#cb12-5"></a>dat_$divlink<span class="op">&lt;-</span><span class="dv">0</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>dat_$conlink<span class="op">&lt;-</span><span class="dv">0</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>dat_$link<span class="op">&lt;-</span><span class="dv">0</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>dat<span class="op">&lt;-</span>dat_</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="cf">for</span>(i <span class="kw">in</span> <span class="dv">1</span>:<span class="dv">23</span>){</span>
<span id="cb12-10"><a href="#cb12-10"></a>    dat$divlink[i]<span class="op">&lt;-</span><span class="bu">sum</span>(W[i,])</span>
<span id="cb12-11"><a href="#cb12-11"></a>    dat$conlink[i]<span class="op">&lt;-</span><span class="bu">sum</span>(W[,i])</span>
<span id="cb12-12"><a href="#cb12-12"></a>    dat$link[i]<span class="op">&lt;-</span><span class="bu">sum</span>(W[i,])<span class="op">+</span><span class="bu">sum</span>(W[i,])</span>
<span id="cb12-13"><a href="#cb12-13"></a>}</span>
<span id="cb12-14"><a href="#cb12-14"></a>p1_<span class="op">&lt;-</span>ggplot(dat)<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink),size<span class="op">=</span><span class="dv">3</span>)<span class="op">+</span>theme_light()<span class="op">+</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>        geom_text_repel(aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink,label<span class="op">=</span>V),col<span class="op">=</span><span class="st">"gray40"</span>)<span class="op">+</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>        ylab(<span class="st">"Out-degree"</span>)<span class="op">+</span>xlab(<span class="st">"Box office record"</span>)<span class="op">+</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="dv">2</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>        ggtitle(<span class="st">"(a)"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">2</span>)))<span class="op">+</span></span>
<span id="cb12-20"><a href="#cb12-20"></a>        theme(axis.title.x<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))<span class="op">+</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>        theme(axis.title.y<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb12-22"><a href="#cb12-22"></a>p2_<span class="op">&lt;-</span>ggplot(dat)<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink),size<span class="op">=</span><span class="dv">3</span>)<span class="op">+</span>theme_light()<span class="op">+</span></span>
<span id="cb12-23"><a href="#cb12-23"></a>        geom_text_repel(aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink,label<span class="op">=</span>V),col<span class="op">=</span><span class="st">"gray40"</span>)<span class="op">+</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>        ylab(<span class="st">"In-degree"</span>)<span class="op">+</span>xlab(<span class="st">"Box office record"</span>)<span class="op">+</span></span>
<span id="cb12-25"><a href="#cb12-25"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="fl">3.75</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb12-26"><a href="#cb12-26"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb12-27"><a href="#cb12-27"></a>        ggtitle(<span class="st">"(b)"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">2</span>)))<span class="op">+</span></span>
<span id="cb12-28"><a href="#cb12-28"></a>        theme(axis.title.x<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))<span class="op">+</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>        theme(axis.title.y<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="co"># p3_&lt;-ggplot(dat)+geom_point(aes(x=f,y=link),size=3)+theme_light()+</span></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="co">#         geom_text_repel(aes(x=f,y=link,label=V),col="gray40")+</span></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="co">#         ylab("Graph")+xlab("Box office record")+</span></span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="co">#         geom_hline(aes(yintercept=6.25),col=2,lty=2,lwd=0.5)+</span></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="co">#         geom_vline(aes(xintercept=1000),col=2,lty=2,lwd=0.5)+</span></span>
<span id="cb12-35"><a href="#cb12-35"></a><span class="co">#         ggtitle("(c)")</span></span>
<span id="cb12-36"><a href="#cb12-36"></a>p1<span class="op">&lt;-</span>grid.arrange(p1_,p2_,ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="co">#ggsave(plot=p1,"./fig/p1.pdf",width=9,height=4.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gfft-수행하고-결과를-저장함." class="level3">
<h3 class="anchored" data-anchor-id="gfft-수행하고-결과를-저장함.">gfft 수행하고 결과를 저장함.</h3>
<div id="cell-16" class="cell" data-execution_count="1192">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="op">%%</span>R </span>
<span id="cb13-2"><a href="#cb13-2"></a>g1<span class="op">&lt;-</span>gfft(f,WEuclid)</span>
<span id="cb13-3"><a href="#cb13-3"></a>g2<span class="op">&lt;-</span>gfft(f,Wgraph)</span>
<span id="cb13-4"><a href="#cb13-4"></a>g3<span class="op">&lt;-</span>gfft(f,Whst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="아이겐플랏" class="level3">
<h3 class="anchored" data-anchor-id="아이겐플랏">아이겐플랏</h3>
<div id="cell-18" class="cell" data-execution_count="1193">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">150</span> <span class="op">-</span>w <span class="dv">1000</span> <span class="op">-</span>h <span class="dv">400</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>library(gridExtra)</span>
<span id="cb14-3"><a href="#cb14-3"></a>e1<span class="op">&lt;-</span>eigenplot(g1)<span class="op">+</span>ggtitle(<span class="st">"(a) Euclid weights"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb14-4"><a href="#cb14-4"></a>e2<span class="op">&lt;-</span>eigenplot(g2)<span class="op">+</span>ggtitle(<span class="st">"(b) Graph weights"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb14-5"><a href="#cb14-5"></a>e3<span class="op">&lt;-</span>eigenplot(g3)<span class="op">+</span>ggtitle(<span class="st">"(c) HST weights"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb14-6"><a href="#cb14-6"></a>s1<span class="op">&lt;-</span>specplot(g1)</span>
<span id="cb14-7"><a href="#cb14-7"></a>s2<span class="op">&lt;-</span>specplot(g2)</span>
<span id="cb14-8"><a href="#cb14-8"></a>s3<span class="op">&lt;-</span>specplot(g3)</span>
<span id="cb14-9"><a href="#cb14-9"></a>p2<span class="op">&lt;-</span>grid.arrange(e1,e2,e3,s1,s2,s3,nrow<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#ggsave(plot=p2,"./fig/p2.pdf",width=6,height=3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="분해" class="level3">
<h3 class="anchored" data-anchor-id="분해">분해</h3>
<div id="cell-20" class="cell" data-execution_count="1194">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2500</span> <span class="op">-</span>h <span class="dv">1500</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>d1<span class="op">&lt;-</span>decompose(f,WEuclid,V<span class="op">=</span>V) <span class="co"># 0, 35000, 60000, 80000</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>d2<span class="op">&lt;-</span>decompose(f,Wgraph,V<span class="op">=</span>V) <span class="co"># 0, 35000, 60000, 80000</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>d3<span class="op">&lt;-</span>decompose(f,Whst,V<span class="op">=</span>V) <span class="co"># 0, 35000, 60000, 80000</span></span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a>d1$case<span class="op">&lt;-</span><span class="st">"Euclid"</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>d2$case<span class="op">&lt;-</span><span class="st">"Graph"</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>d3$case<span class="op">&lt;-</span><span class="st">"HST"</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>decomprslt<span class="op">&lt;-</span>rbind(d1,d2,d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-21" class="cell" data-execution_count="1195">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">150</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">4200</span></span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a>decomp_dat<span class="op">&lt;-</span> decomprslt <span class="op">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4"></a>                group_by(case,eigenvectorindex) <span class="op">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5"></a>                mutate(textsize<span class="op">=</span> <span class="dv">10</span><span class="op">*</span>(<span class="bu">abs</span>(fhat)<span class="op">&gt;</span><span class="dv">50</span>))</span>
<span id="cb16-6"><a href="#cb16-6"></a>        </span>
<span id="cb16-7"><a href="#cb16-7"></a>p3<span class="op">&lt;-</span>ggplot(data<span class="op">=</span><span class="bu">filter</span>(decomp_dat,eigenvectorindex <span class="op">%</span><span class="kw">in</span><span class="op">%</span> <span class="dv">1</span>:<span class="dv">23</span>))<span class="op">+</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>    geom_col(aes(x<span class="op">=</span>Vindex,y<span class="op">=</span>fhat,fill<span class="op">=</span>fhat<span class="op">&gt;</span><span class="dv">0</span>),width<span class="op">=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>    geom_text_repel(aes(x<span class="op">=</span>Vindex,y<span class="op">=</span>fhat,label<span class="op">=</span>V,size<span class="op">=</span>textsize),col<span class="op">=</span><span class="dv">1</span>,fontface<span class="op">=</span><span class="dv">4</span>,alpha<span class="op">=</span><span class="fl">0.8</span>,segment.size<span class="op">=</span><span class="fl">0.2</span>,segment.color<span class="op">=</span><span class="st">"gray60"</span>,<span class="bu">min</span>.segment.length<span class="op">=</span><span class="dv">5</span>,hjust<span class="op">=</span><span class="fl">0.1</span>)<span class="op">+</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>    scale_radius(<span class="bu">range</span> <span class="op">=</span> c(<span class="dv">0</span>,<span class="fl">1.8</span>))<span class="op">+</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>    guides(size<span class="op">=</span>FALSE)<span class="op">+</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>    facet_grid(eigenvectorindex<span class="op">~</span>case)<span class="op">+</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>    geom_hline(aes(yintercept<span class="op">=</span><span class="dv">0</span>),col<span class="op">=</span><span class="st">"gray60"</span>,lty<span class="op">=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>    xlab(<span class="st">""</span>)<span class="op">+</span>ylab(<span class="st">""</span>)<span class="op">+</span>guides(fill<span class="op">=</span>FALSE)<span class="op">+</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>    theme(axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">85</span>,hjust<span class="op">=</span><span class="dv">1</span>,vjust<span class="op">=</span><span class="dv">1</span>,face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="fl">0.7</span>),colour<span class="op">=</span><span class="st">"gray60"</span>))<span class="op">+</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>    theme_light()<span class="op">+</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>    theme(strip.text.x <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>    theme(strip.text.y <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>    theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="fl">1.5</span>)))</span>
<span id="cb16-20"><a href="#cb16-20"></a>show(p3)</span>
<span id="cb16-21"><a href="#cb16-21"></a></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="co"># decomp_dat&lt;- decomprslt %&gt;% </span></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co">#                 group_by(case,eigenvectorindex) %&gt;% </span></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co">#                 mutate(textsize=(fhat&gt;mean(fhat)) *(fhat&gt;240) * ((case=="Euclid")*1.7+</span></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="co">#                                                                  (case!="Euclid")*(eigenvectorindex!=1)*1.7+</span></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="co">#                                                                  (case!="Euclid")*(eigenvectorindex==1)*1))</span></span>
<span id="cb16-27"><a href="#cb16-27"></a></span>
<span id="cb16-28"><a href="#cb16-28"></a></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co"># p3&lt;-ggplot(data=filter(decomp_dat,eigenvectorindex %in% 1:7))+</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="co">#     geom_col(aes(x=Vindex,y=fhat,fill=fhat&gt;0),width=0.7)+</span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="co">#     geom_text_repel(aes(x=Vindex,y=fhat,label=V,size=textsize),col=1,fontface=4,alpha=0.8,segment.size=0.2,segment.color="gray60",min.segment.length=5,hjust=0.1)+</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co">#     scale_radius(range = c(0,1.8))+</span></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="co">#     guides(size=FALSE)+</span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="co">#     facet_grid(eigenvectorindex~case)+</span></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="co">#     geom_hline(aes(yintercept=0),col="gray60",lty=2)+</span></span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="co">#     xlab("")+ylab("")+guides(fill=FALSE)+</span></span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="co">#     theme(axis.text.x=element_text(angle=85,hjust=1,vjust=1,face=4,size=rel(0.7),colour="gray60"))+</span></span>
<span id="cb16-38"><a href="#cb16-38"></a><span class="co">#     theme_light()+</span></span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="co">#     theme(strip.text.x = element_text(size = 10, color = "black", face = "bold.italic"))+</span></span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="co">#     theme(strip.text.y = element_text(size = 10, color = "black", face = "bold.italic"))+</span></span>
<span id="cb16-41"><a href="#cb16-41"></a><span class="co">#     theme(plot.title=element_text(face="bold.italic",size=rel(1.5)))</span></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="co"># show(p3)</span></span>
<span id="cb16-43"><a href="#cb16-43"></a><span class="co">#ggsave(plot=p3,"./fig/p3.pdf",width=6,height=6)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="1196">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="op">%%</span>R</span>
<span id="cb17-2"><a href="#cb17-2"></a>dat3_Euclid <span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Euclid"</span>,eigenvectorindex<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb17-3"><a href="#cb17-3"></a>dat3_Euclid <span class="op">&lt;-</span> left_join(dat,dat3_Euclid,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="cf">for</span>(j <span class="kw">in</span> <span class="dv">2</span>:<span class="dv">23</span>){</span>
<span id="cb17-6"><a href="#cb17-6"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Euclid"</span>,eigenvectorindex<span class="op">==</span>j) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb17-7"><a href="#cb17-7"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> left_join(dat,decomp_filtered_dat_,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb17-8"><a href="#cb17-8"></a>        dat3_Euclid<span class="op">&lt;-</span>rbind(dat3_Euclid,decomp_filtered_dat_)</span>
<span id="cb17-9"><a href="#cb17-9"></a>}</span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a>dat3_Graph <span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Graph"</span>,eigenvectorindex<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb17-12"><a href="#cb17-12"></a>dat3_Graph <span class="op">&lt;-</span> left_join(dat,dat3_Graph,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb17-13"><a href="#cb17-13"></a></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="cf">for</span>(j <span class="kw">in</span> <span class="dv">2</span>:<span class="dv">23</span>){</span>
<span id="cb17-15"><a href="#cb17-15"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Graph"</span>,eigenvectorindex<span class="op">==</span>j) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb17-16"><a href="#cb17-16"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> left_join(dat,decomp_filtered_dat_,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb17-17"><a href="#cb17-17"></a>        dat3_Graph<span class="op">&lt;-</span>rbind(dat3_Graph,decomp_filtered_dat_)</span>
<span id="cb17-18"><a href="#cb17-18"></a>}</span>
<span id="cb17-19"><a href="#cb17-19"></a></span>
<span id="cb17-20"><a href="#cb17-20"></a>dat3_HST <span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"HST"</span>,eigenvectorindex<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb17-21"><a href="#cb17-21"></a>dat3_HST <span class="op">&lt;-</span> left_join(dat,dat3_HST,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb17-22"><a href="#cb17-22"></a></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="cf">for</span>(j <span class="kw">in</span> <span class="dv">2</span>:<span class="dv">23</span>){</span>
<span id="cb17-24"><a href="#cb17-24"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"HST"</span>,eigenvectorindex<span class="op">==</span>j) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb17-25"><a href="#cb17-25"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> left_join(dat,decomp_filtered_dat_,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb17-26"><a href="#cb17-26"></a>        dat3_HST<span class="op">&lt;-</span>rbind(dat3_HST,decomp_filtered_dat_)</span>
<span id="cb17-27"><a href="#cb17-27"></a>}</span>
<span id="cb17-28"><a href="#cb17-28"></a>dat3<span class="op">&lt;-</span>rbind(dat3_Euclid,dat3_Graph,dat3_HST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell" data-execution_count="1144">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">3000</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>hull_cyl <span class="op">&lt;-</span> dat3 <span class="op">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>            group_by(case,eigenvectorindex) <span class="op">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4"></a>            <span class="bu">filter</span>(textsize<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5"></a>            <span class="bu">slice</span>(chull(f, divlink))</span>
<span id="cb18-6"><a href="#cb18-6"></a>p4<span class="op">&lt;-</span>ggplot(dat3<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>))<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink,col<span class="op">=</span>textsize<span class="op">&gt;</span><span class="dv">0</span>,size<span class="op">=</span>fhat<span class="op">*</span>(fhat<span class="op">&gt;</span><span class="dv">0</span>)),alpha<span class="op">=</span><span class="fl">0.8</span>)<span class="op">+</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>        geom_shape(data<span class="op">=</span>hull_cyl<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>) ,aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink),alpha<span class="op">=</span><span class="fl">0.05</span>,col<span class="op">=</span><span class="st">"gray30"</span>,radius<span class="op">=</span><span class="fl">0.05</span>,expand<span class="op">=</span><span class="fl">0.05</span>)<span class="op">+</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>        facet_grid(eigenvectorindex<span class="op">~</span>case)<span class="op">+</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>        scale_size_continuous(<span class="bu">range</span><span class="op">=</span>c(<span class="dv">2</span>,<span class="fl">2.5</span>))<span class="op">+</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>        scale_color_manual(values<span class="op">=</span>c(<span class="st">"gray80"</span>, <span class="st">"gray20"</span>))<span class="op">+</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>        ylim(<span class="dv">0</span>,<span class="dv">8</span>)<span class="op">+</span>xlim(<span class="dv">0</span>,<span class="dv">3000</span>)<span class="op">+</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>        guides(alpha<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>        guides(col<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>        guides(size<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>        ylab(<span class="st">""</span>)<span class="op">+</span>xlab(<span class="st">""</span>)<span class="op">+</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="dv">2</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb18-18"><a href="#cb18-18"></a>        theme_light()<span class="op">+</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>        theme(strip.text.x <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>        theme(strip.text.y <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb18-21"><a href="#cb18-21"></a>        theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="fl">1.5</span>)))</span>
<span id="cb18-22"><a href="#cb18-22"></a>show(p4)</span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co">#ggsave(plot=p4,"./fig/p4.pdf",width=7,height=7)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="1020">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">3000</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>hull_cyl <span class="op">&lt;-</span> dat3 <span class="op">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>            group_by(case,eigenvectorindex) <span class="op">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4"></a>            <span class="bu">filter</span>(textsize<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">%&gt;%</span> </span>
<span id="cb19-5"><a href="#cb19-5"></a>            <span class="bu">slice</span>(chull(f, conlink))</span>
<span id="cb19-6"><a href="#cb19-6"></a>p5<span class="op">&lt;-</span>ggplot(dat3<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>))<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink,col<span class="op">=</span>textsize<span class="op">&gt;</span><span class="dv">0</span>,size<span class="op">=</span>fhat<span class="op">*</span>(fhat<span class="op">&gt;</span><span class="dv">0</span>)),alpha<span class="op">=</span><span class="fl">0.8</span>)<span class="op">+</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>        geom_shape(data<span class="op">=</span>hull_cyl<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>) ,aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink),alpha<span class="op">=</span><span class="fl">0.05</span>,col<span class="op">=</span><span class="st">"gray30"</span>,radius<span class="op">=</span><span class="fl">0.05</span>,expand<span class="op">=</span><span class="fl">0.05</span>)<span class="op">+</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>        facet_grid(eigenvectorindex<span class="op">~</span>case)<span class="op">+</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>        scale_size_continuous(<span class="bu">range</span><span class="op">=</span>c(<span class="dv">2</span>,<span class="fl">2.5</span>))<span class="op">+</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>        scale_color_manual(values<span class="op">=</span>c(<span class="st">"gray80"</span>, <span class="st">"gray20"</span>))<span class="op">+</span>        </span>
<span id="cb19-11"><a href="#cb19-11"></a>        ylim(<span class="dv">0</span>,<span class="dv">10</span>)<span class="op">+</span>xlim(<span class="dv">0</span>,<span class="dv">3000</span>)<span class="op">+</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>        guides(col<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>        guides(alpha<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>        guides(size<span class="op">=</span>F)<span class="op">+</span>       </span>
<span id="cb19-15"><a href="#cb19-15"></a>        ylab(<span class="st">""</span>)<span class="op">+</span>xlab(<span class="st">""</span>)<span class="op">+</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="fl">3.75</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb19-18"><a href="#cb19-18"></a>        theme_light()<span class="op">+</span></span>
<span id="cb19-19"><a href="#cb19-19"></a>        theme(strip.text.x <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb19-20"><a href="#cb19-20"></a>        theme(strip.text.y <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb19-21"><a href="#cb19-21"></a>        theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="fl">1.5</span>)))</span>
<span id="cb19-22"><a href="#cb19-22"></a>show(p5)</span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#ggsave(plot=p5,"./fig/p5.pdf",width=7,height=7)        </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="855">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">1500</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>p_<span class="op">&lt;-</span>grid.arrange(p4,p5,ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#ggsave(plot=p6,"./fig/p6.pdf",width=10,height=12)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="817">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">200</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">3000</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>p6<span class="op">&lt;-</span>grid.arrange(p1,p_,nrow<span class="op">=</span><span class="dv">2</span>,heights<span class="op">=</span>c(<span class="dv">3</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="op">%</span>run heavysnow </span>
<span id="cb22-2"><a href="#cb22-2"></a>gs<span class="op">=</span>GraphSignal(V,hst.snowweight,f)</span>
<span id="cb22-3"><a href="#cb22-3"></a>spa<span class="op">=</span>SpectralAnalysis(gs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-30" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>spa.n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>23</code></pre>
</div>
</div>
<div id="cell-31" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>spa.graphFouriertransform()</span>
<span id="cb25-2"><a href="#cb25-2"></a>spa.decompose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-32" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>spa.V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array(['Iron Man', 'The Incredible Hulk', 'Iron Man 2', 'Thor',
       'Captain America: The First Avenger', 'The Avengers', 'Iron Man 3',
       'Thor: The Dark World', 'Captain America: The Winter Soldier',
       'Guardians of the Galaxy', 'Avengers: Age of Ultron', 'Ant-man',
       'Captain America: Civil War', 'Doctor Strange',
       'Guardians of the Galaxy Vol 2', 'Spider-man: Homecoming',
       'Thor: Ragnarok', 'Black Panther', 'Avengers: Infinity War',
       'Ant-man and the Wasp', 'Captain Marvel', 'Avengers: Endgame',
       'Spider-man: Far From Home'], dtype=object)</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>df<span class="op">=</span>pd.DataFrame(spa.components)</span>
<span id="cb28-2"><a href="#cb28-2"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
<th data-quarto-table-cell-role="th">21</th>
<th data-quarto-table-cell-role="th">22</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6.247290e-15</td>
<td>1.707095e+03</td>
<td>-9.827837e-14</td>
<td>-8.486396e-14</td>
<td>2.899762e-14</td>
<td>6.041645e-15</td>
<td>-1.187456e-14</td>
<td>-3.502007e-13</td>
<td>-1.193541e-13</td>
<td>3.794379e-13</td>
<td>...</td>
<td>-1.121921e+03</td>
<td>-3.548465e-14</td>
<td>-1.892759e-14</td>
<td>4.544603e-13</td>
<td>-1.900950e-14</td>
<td>8.032471e-14</td>
<td>-8.990956e-10</td>
<td>-1.633610e-13</td>
<td>-7.430218e-14</td>
<td>-6.028971e-15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.712215e-16</td>
<td>1.058137e-08</td>
<td>-5.007274e-14</td>
<td>3.386473e-17</td>
<td>1.420744e-11</td>
<td>-1.437544e-15</td>
<td>-1.321678e-14</td>
<td>4.039994e-15</td>
<td>-2.833873e-14</td>
<td>-1.633926e-10</td>
<td>...</td>
<td>-6.954407e-09</td>
<td>-4.113024e-11</td>
<td>4.516539e-14</td>
<td>5.644640e-16</td>
<td>-3.435360e-04</td>
<td>9.652342e-16</td>
<td>1.450493e+02</td>
<td>6.727200e-10</td>
<td>4.158595e-16</td>
<td>-1.646478e-14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.567872e-01</td>
<td>-3.517889e-13</td>
<td>4.205928e+00</td>
<td>3.135672e-01</td>
<td>1.237232e-13</td>
<td>1.002442e+01</td>
<td>1.419019e+00</td>
<td>-6.420902e-01</td>
<td>-2.586033e+00</td>
<td>-3.800564e-15</td>
<td>...</td>
<td>4.504242e-14</td>
<td>3.881354e-15</td>
<td>-7.222631e+00</td>
<td>-1.270091e-01</td>
<td>-3.911058e-13</td>
<td>1.458953e+03</td>
<td>-6.970078e-17</td>
<td>-4.258602e-14</td>
<td>-7.984930e+02</td>
<td>-1.051491e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.059263e-14</td>
<td>-4.888031e-13</td>
<td>-2.398614e-13</td>
<td>-5.563074e-14</td>
<td>4.899172e-01</td>
<td>5.509354e-14</td>
<td>3.093273e-14</td>
<td>-5.194113e-13</td>
<td>-5.543531e-14</td>
<td>5.360109e+02</td>
<td>...</td>
<td>2.551620e-13</td>
<td>-1.247248e+02</td>
<td>-2.667641e-14</td>
<td>1.290511e-13</td>
<td>-1.099014e-04</td>
<td>-4.141358e-14</td>
<td>-1.039357e-10</td>
<td>3.755068e+01</td>
<td>-1.017089e-14</td>
<td>5.754851e-14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.338283e-14</td>
<td>3.813154e-13</td>
<td>5.864303e-14</td>
<td>6.890875e-14</td>
<td>1.634047e+02</td>
<td>-5.976314e-14</td>
<td>-2.108992e-14</td>
<td>2.695599e-13</td>
<td>7.059745e-14</td>
<td>-3.468382e+02</td>
<td>...</td>
<td>-4.555950e-13</td>
<td>-6.202443e+01</td>
<td>3.944487e-13</td>
<td>-2.381748e-13</td>
<td>-2.477574e-03</td>
<td>-3.908796e-14</td>
<td>-2.329564e-09</td>
<td>6.160302e+02</td>
<td>-3.849599e-14</td>
<td>-2.522857e-14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6.268624e-01</td>
<td>5.025556e-14</td>
<td>3.621003e+00</td>
<td>3.780309e+02</td>
<td>-3.789023e-13</td>
<td>-9.031218e-02</td>
<td>-6.086432e-01</td>
<td>1.451182e+03</td>
<td>-8.818405e-01</td>
<td>2.446920e-13</td>
<td>...</td>
<td>-4.128901e-13</td>
<td>-1.945880e-14</td>
<td>1.479923e+00</td>
<td>-3.154052e+02</td>
<td>2.823262e-20</td>
<td>2.283802e-02</td>
<td>-1.940234e-16</td>
<td>-4.831462e-14</td>
<td>-4.437603e-02</td>
<td>6.842734e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>3.634492e+00</td>
<td>0.000000e+00</td>
<td>2.251986e+01</td>
<td>3.648403e+02</td>
<td>1.237232e-13</td>
<td>-5.152353e-01</td>
<td>-5.098148e+00</td>
<td>-4.000544e+02</td>
<td>-8.218727e+00</td>
<td>-8.219362e-14</td>
<td>...</td>
<td>3.071239e-13</td>
<td>4.246548e-15</td>
<td>1.439908e+01</td>
<td>1.215892e+03</td>
<td>-2.276049e-20</td>
<td>1.454592e-01</td>
<td>1.091523e-16</td>
<td>2.670230e-14</td>
<td>-3.092549e-01</td>
<td>4.780988e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.469804e+00</td>
<td>2.680297e-13</td>
<td>-1.084964e+01</td>
<td>-2.645684e-01</td>
<td>6.263487e-13</td>
<td>1.490922e+02</td>
<td>1.817207e+00</td>
<td>1.485871e+00</td>
<td>5.348931e+00</td>
<td>-2.997392e-13</td>
<td>...</td>
<td>2.165643e-13</td>
<td>2.126956e-14</td>
<td>1.003275e+01</td>
<td>1.777094e+00</td>
<td>9.978330e-19</td>
<td>-1.753933e+00</td>
<td>2.539023e-15</td>
<td>1.997032e-13</td>
<td>6.687601e+00</td>
<td>-7.156614e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-8.116393e+00</td>
<td>1.675185e-13</td>
<td>-6.823096e+01</td>
<td>-2.585005e+00</td>
<td>-1.546540e-13</td>
<td>8.415274e+01</td>
<td>6.742951e+00</td>
<td>1.147843e+01</td>
<td>3.914723e+01</td>
<td>-5.540890e-14</td>
<td>...</td>
<td>-1.694475e-13</td>
<td>6.807886e-16</td>
<td>7.498935e+01</td>
<td>1.348579e+01</td>
<td>-3.385392e-18</td>
<td>-6.612900e+00</td>
<td>-3.888607e-15</td>
<td>1.516414e-13</td>
<td>2.824586e+01</td>
<td>-6.751284e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.457985e+02</td>
<td>1.340148e-13</td>
<td>9.688547e+02</td>
<td>-1.627500e-01</td>
<td>3.093080e-14</td>
<td>7.405009e-01</td>
<td>-1.841870e+00</td>
<td>2.753373e+00</td>
<td>-5.049281e+01</td>
<td>2.737548e-14</td>
<td>...</td>
<td>-8.177666e-14</td>
<td>-7.010920e-15</td>
<td>-8.832644e+00</td>
<td>4.080923e+00</td>
<td>5.407829e-20</td>
<td>-7.998628e-02</td>
<td>3.110801e-15</td>
<td>-6.383287e-14</td>
<td>3.682641e-01</td>
<td>1.447229e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>6.907220e+01</td>
<td>2.680297e-13</td>
<td>6.433580e+02</td>
<td>-6.595574e-01</td>
<td>4.021004e-13</td>
<td>-4.700005e-01</td>
<td>4.265512e+00</td>
<td>-3.580883e+00</td>
<td>6.750131e+02</td>
<td>-3.291044e-14</td>
<td>...</td>
<td>-2.470088e-13</td>
<td>-1.671705e-14</td>
<td>3.531860e+01</td>
<td>-7.096645e+00</td>
<td>-6.576134e-19</td>
<td>3.818266e-02</td>
<td>5.714582e-15</td>
<td>-1.327708e-13</td>
<td>-2.015752e-01</td>
<td>-6.434574e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>1.463660e+01</td>
<td>1.340148e-13</td>
<td>1.103874e+02</td>
<td>-3.273026e+00</td>
<td>4.059667e-13</td>
<td>5.031685e+00</td>
<td>1.379003e+02</td>
<td>4.407592e+00</td>
<td>-5.729486e+01</td>
<td>-1.630527e-13</td>
<td>...</td>
<td>-1.519603e-13</td>
<td>2.150495e-14</td>
<td>2.642115e+02</td>
<td>-1.013413e+00</td>
<td>2.467838e-18</td>
<td>-1.329087e+00</td>
<td>1.306457e-14</td>
<td>-3.994124e-14</td>
<td>5.810507e+00</td>
<td>1.103411e+02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2.042957e+01</td>
<td>6.700742e-14</td>
<td>1.604964e+02</td>
<td>1.760594e+00</td>
<td>-6.031506e-13</td>
<td>-4.010409e+00</td>
<td>2.059552e+01</td>
<td>-4.051919e+00</td>
<td>-1.275852e+02</td>
<td>6.623007e-14</td>
<td>...</td>
<td>1.551758e-13</td>
<td>-1.177289e-14</td>
<td>1.186266e+03</td>
<td>-3.177545e+00</td>
<td>2.097188e-18</td>
<td>1.912961e-01</td>
<td>-7.902333e-15</td>
<td>-9.644055e-14</td>
<td>-1.219998e+00</td>
<td>-7.250937e+01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>6.668434e+01</td>
<td>1.340148e-13</td>
<td>4.618421e+02</td>
<td>-1.859682e+01</td>
<td>-6.186160e-13</td>
<td>-2.507029e+01</td>
<td>-1.107716e+02</td>
<td>6.813721e+00</td>
<td>-2.345541e+02</td>
<td>1.556516e-14</td>
<td>...</td>
<td>1.339132e-13</td>
<td>4.870343e-15</td>
<td>2.608371e+02</td>
<td>-5.710231e+01</td>
<td>-2.579978e-18</td>
<td>3.369735e+00</td>
<td>1.420847e-17</td>
<td>1.264037e-13</td>
<td>-2.913932e+01</td>
<td>8.693155e+01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>3.422525e-14</td>
<td>-8.940864e-14</td>
<td>1.037470e-13</td>
<td>-3.364652e-14</td>
<td>1.082258e+03</td>
<td>-4.474060e-14</td>
<td>-1.322970e-13</td>
<td>5.440031e-13</td>
<td>-4.988318e-13</td>
<td>-3.546742e+01</td>
<td>...</td>
<td>2.216706e-13</td>
<td>-9.831858e+00</td>
<td>6.181378e-13</td>
<td>-1.170664e-13</td>
<td>1.322688e-02</td>
<td>-5.095742e-13</td>
<td>1.623088e-08</td>
<td>-1.732161e+02</td>
<td>1.503337e-13</td>
<td>-2.027809e-14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>-6.106282e-15</td>
<td>-4.014393e-13</td>
<td>-3.966886e-14</td>
<td>1.328179e-14</td>
<td>-1.604103e-02</td>
<td>1.036244e-14</td>
<td>-6.330841e-15</td>
<td>-4.115207e-14</td>
<td>2.341767e-14</td>
<td>-8.891039e-04</td>
<td>...</td>
<td>-3.211852e-13</td>
<td>-1.551127e-04</td>
<td>4.475967e-14</td>
<td>-3.631372e-14</td>
<td>8.801798e+02</td>
<td>6.468891e-13</td>
<td>1.106361e-03</td>
<td>3.872341e-03</td>
<td>-3.664909e-13</td>
<td>5.779847e-15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>-6.667865e+01</td>
<td>2.680297e-13</td>
<td>-4.738936e+02</td>
<td>-1.007199e+02</td>
<td>1.237232e-13</td>
<td>-9.769302e+01</td>
<td>-6.283744e+00</td>
<td>2.978993e+02</td>
<td>2.671375e+02</td>
<td>-6.366001e-15</td>
<td>...</td>
<td>1.847935e-13</td>
<td>-1.586313e-15</td>
<td>2.938494e+02</td>
<td>2.466987e+02</td>
<td>-2.673912e-19</td>
<td>-5.211991e+01</td>
<td>5.876455e-21</td>
<td>-1.717282e-14</td>
<td>-1.079660e+02</td>
<td>2.525438e+01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>-8.130269e+00</td>
<td>1.340148e-13</td>
<td>-6.563066e+01</td>
<td>-3.230602e+02</td>
<td>-1.546540e-13</td>
<td>5.434013e+01</td>
<td>-2.813232e+01</td>
<td>9.334007e+02</td>
<td>4.237280e+01</td>
<td>3.274076e-15</td>
<td>...</td>
<td>-6.704179e-14</td>
<td>8.977368e-16</td>
<td>1.263153e+02</td>
<td>7.489960e+02</td>
<td>3.979446e-20</td>
<td>1.464130e+02</td>
<td>-2.815570e-21</td>
<td>9.029172e-15</td>
<td>1.173458e+02</td>
<td>1.800376e+01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>-1.187357e+01</td>
<td>1.340148e-13</td>
<td>-8.462116e+01</td>
<td>5.170168e+01</td>
<td>8.179912e-63</td>
<td>-1.000490e+01</td>
<td>-7.699697e+00</td>
<td>-1.503880e+02</td>
<td>4.833255e+01</td>
<td>1.592742e-14</td>
<td>...</td>
<td>2.236371e-14</td>
<td>2.012683e-15</td>
<td>7.302472e+01</td>
<td>-1.224382e+02</td>
<td>-2.141600e-18</td>
<td>1.430858e+03</td>
<td>-1.839765e-20</td>
<td>1.335035e-14</td>
<td>7.841594e+02</td>
<td>8.491160e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>5.695819e-04</td>
<td>1.092131e-02</td>
<td>4.100482e-03</td>
<td>-1.356002e-03</td>
<td>1.068875e+02</td>
<td>-5.208507e-04</td>
<td>5.581691e-04</td>
<td>3.978264e-03</td>
<td>-2.372015e-03</td>
<td>2.308013e+02</td>
<td>...</td>
<td>7.177600e-03</td>
<td>5.073098e+01</td>
<td>-4.074587e-03</td>
<td>3.292610e-03</td>
<td>-4.969979e-03</td>
<td>2.041970e-03</td>
<td>1.247561e+02</td>
<td>2.112912e+02</td>
<td>8.552650e-04</td>
<td>-5.052201e-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>5.899266e+01</td>
<td>1.674174e+02</td>
<td>4.246946e+02</td>
<td>-1.404436e+02</td>
<td>-4.895903e+01</td>
<td>-5.394548e+01</td>
<td>5.781061e+01</td>
<td>4.120362e+02</td>
<td>-2.456740e+02</td>
<td>-1.057168e+02</td>
<td>...</td>
<td>1.100285e+02</td>
<td>-2.323695e+01</td>
<td>-4.220126e+02</td>
<td>3.410218e+02</td>
<td>-1.115816e-03</td>
<td>2.114906e+02</td>
<td>2.010064e+01</td>
<td>-9.678036e+01</td>
<td>8.858139e+01</td>
<td>-5.232658e+01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>8.370471e+00</td>
<td>1.155986e+03</td>
<td>6.025994e+01</td>
<td>-1.992755e+01</td>
<td>1.303271e+02</td>
<td>-7.654326e+00</td>
<td>8.202750e+00</td>
<td>5.846383e+01</td>
<td>-3.485870e+01</td>
<td>2.814142e+02</td>
<td>...</td>
<td>7.597260e+02</td>
<td>6.185588e+01</td>
<td>-5.987939e+01</td>
<td>4.838760e+01</td>
<td>2.970488e-03</td>
<td>3.000842e+01</td>
<td>-5.351234e+01</td>
<td>2.576257e+02</td>
<td>1.256882e+01</td>
<td>-7.424621e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>-1.570579e+01</td>
<td>1.244926e+03</td>
<td>-1.130677e+02</td>
<td>3.739071e+01</td>
<td>-1.144332e+02</td>
<td>1.436206e+01</td>
<td>-1.539109e+01</td>
<td>-1.096976e+02</td>
<td>6.540651e+01</td>
<td>-2.470946e+02</td>
<td>...</td>
<td>8.181785e+02</td>
<td>-5.431231e+01</td>
<td>1.123536e+02</td>
<td>-9.079122e+01</td>
<td>-2.608172e-03</td>
<td>-5.630576e+01</td>
<td>4.698508e+01</td>
<td>-2.262072e+02</td>
<td>-2.358328e+01</td>
<td>1.393106e+01</td>
</tr>
</tbody>
</table>

<p>23 rows × 23 columns</p>
</div>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>df<span class="op">=</span>df.stack().reset_index().rename(columns<span class="op">=</span>{<span class="st">'level_0'</span>:<span class="st">'vertex'</span>,<span class="st">'level_1'</span>:<span class="st">'comp'</span>,<span class="dv">0</span>:<span class="st">'fhat'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>df </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">vertex</th>
<th data-quarto-table-cell-role="th">comp</th>
<th data-quarto-table-cell-role="th">fhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>6.247290e-15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>1</td>
<td>1.707095e+03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>2</td>
<td>-9.827837e-14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>3</td>
<td>-8.486396e-14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>4</td>
<td>2.899762e-14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">524</td>
<td>22</td>
<td>18</td>
<td>-5.630576e+01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">525</td>
<td>22</td>
<td>19</td>
<td>4.698508e+01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">526</td>
<td>22</td>
<td>20</td>
<td>-2.262072e+02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">527</td>
<td>22</td>
<td>21</td>
<td>-2.358328e+01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">528</td>
<td>22</td>
<td>22</td>
<td>1.393106e+01</td>
</tr>
</tbody>
</table>

<p>529 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>df[<span class="st">'fill'</span>]<span class="op">=</span> df.fhat <span class="op">&gt;</span><span class="dv">0</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-37" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">vertex</th>
<th data-quarto-table-cell-role="th">comp</th>
<th data-quarto-table-cell-role="th">fhat</th>
<th data-quarto-table-cell-role="th">fill</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>6.247290e-15</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>1</td>
<td>1.707095e+03</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>2</td>
<td>-9.827837e-14</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>3</td>
<td>-8.486396e-14</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>4</td>
<td>2.899762e-14</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">524</td>
<td>22</td>
<td>18</td>
<td>-5.630576e+01</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">525</td>
<td>22</td>
<td>19</td>
<td>4.698508e+01</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">526</td>
<td>22</td>
<td>20</td>
<td>-2.262072e+02</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">527</td>
<td>22</td>
<td>21</td>
<td>-2.358328e+01</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">528</td>
<td>22</td>
<td>22</td>
<td>1.393106e+01</td>
<td>True</td>
</tr>
</tbody>
</table>

<p>529 rows × 4 columns</p>
</div>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>n<span class="op">=</span><span class="dv">23</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>fig<span class="op">=</span>ggplot(df)</span>
<span id="cb33-3"><a href="#cb33-3"></a>facet<span class="op">=</span>facet_wrap(<span class="st">'comp'</span>,ncol<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a>aes1<span class="op">=</span>aes(x<span class="op">=</span><span class="st">'vertex'</span>,y<span class="op">=</span><span class="st">'fhat'</span>,fill<span class="op">=</span><span class="st">'fill'</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a>aes3<span class="op">=</span>aes(x<span class="op">=</span><span class="st">'vertex'</span>,y<span class="op">=</span><span class="st">'fhat'</span>,label<span class="op">=</span>spa.V)</span>
<span id="cb33-6"><a href="#cb33-6"></a>geom1<span class="op">=</span>geom_col(aes1,alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb33-7"><a href="#cb33-7"></a>geom2<span class="op">=</span>geom_hline(yintercept <span class="op">=</span> <span class="dv">0</span>,linetype<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'gray'</span>,size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="co">#geom3=geom_text_repel(aes(x=Vindex,y=fhat,label=V)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-39" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>fig<span class="op">+</span>facet<span class="op">+</span>geom1<span class="op">+</span>geom2<span class="op">+</span>xlab(<span class="st">""</span>)<span class="op">+</span>ylab(<span class="st">""</span>)<span class="op">+</span>theme(figure_size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">3</span><span class="op">*</span>n))<span class="op">+</span>theme(legend_position<span class="op">=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-08-15-HST example 3_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="miruetoto/yechan3" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>