<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.520">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="신록예찬">
<meta name="dcterms.date" content="2021-10-29">

<title>신록예찬’s Blog - (연구&amp;교수님) HST example 3, 파이썬으로 변경</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">신록예찬’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DL2022/"> 
<span class="menu-text">DL2022</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/AP2023/"> 
<span class="menu-text">AP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/PP2023/"> 
<span class="menu-text">PP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DV2023/"> 
<span class="menu-text">DV2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/MP2023/"> 
<span class="menu-text">MP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/SC2022/"> 
<span class="menu-text">SC2022</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/DS2022/"> 
<span class="menu-text">DS2022</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/SP2023/"> 
<span class="menu-text">SP2023</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://guebin.github.io/IR2021/"> 
<span class="menu-text">IR2021</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://miruetoto.github.io/yechan/"> 
<span class="menu-text">yechan</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://miruetoto.github.io/yechan2/"> 
<span class="menu-text">yechan2</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/miruetoto/yechan3"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">(연구&amp;교수님) HST example 3, 파이썬으로 변경</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../메모.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">메모</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../공부.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공부</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../연구.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">연구</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../자료.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">자료</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">import</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">load data</a></li>
  <li><a href="#scatter-plot" id="toc-scatter-plot" class="nav-link" data-scroll-target="#scatter-plot">scatter plot</a></li>
  <li><a href="#hst" id="toc-hst" class="nav-link" data-scroll-target="#hst">HST</a></li>
  <li><a href="#spectral-analysis" id="toc-spectral-analysis" class="nav-link" data-scroll-target="#spectral-analysis">Spectral analysis</a></li>
  <li><a href="#유클리드와-그래프도메인의-정보를-플랏." id="toc-유클리드와-그래프도메인의-정보를-플랏." class="nav-link" data-scroll-target="#유클리드와-그래프도메인의-정보를-플랏.">유클리드와 그래프도메인의 정보를 플랏.</a></li>
  <li><a href="#gfft-수행하고-결과를-저장함." id="toc-gfft-수행하고-결과를-저장함." class="nav-link" data-scroll-target="#gfft-수행하고-결과를-저장함.">gfft 수행하고 결과를 저장함.</a></li>
  <li><a href="#아이겐플랏" id="toc-아이겐플랏" class="nav-link" data-scroll-target="#아이겐플랏">아이겐플랏</a></li>
  <li><a href="#분해" id="toc-분해" class="nav-link" data-scroll-target="#분해">분해</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2021-10-29-HST example 3 파이썬으로 변경.out.ipynb" download="2021-10-29-HST example 3 파이썬으로 변경.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">(연구&amp;교수님) HST example 3, 파이썬으로 변경</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>신록예찬 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 29, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="import" class="level3">
<h3 class="anchored" data-anchor-id="import">import</h3>
<div id="cell-2" class="cell" data-execution_count="390">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">## 1. remove trash</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#!rm -rf ~/.local/share/Trash/files/*</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#matplotlib.rc('image', cmap='Greys')</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">import</span> rpy2 </span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">from</span> adjustText <span class="im">import</span> adjust_text</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="op">%</span>load_ext rpy2.ipython</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="op">%</span>run heavysnow </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The rpy2.ipython extension is already loaded. To reload it, use:
  %reload_ext rpy2.ipython</code></pre>
</div>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">load data</h3>
<div id="cell-4" class="cell" data-execution_count="391">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>n<span class="op">=</span><span class="dv">23</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>f<span class="op">=</span>np.array(pd.read_csv(<span class="st">"2021-08-15-MCU-ticket.csv"</span>).Worldwide)<span class="op">/</span><span class="dv">1000000</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>V<span class="op">=</span>np.array(pd.read_csv(<span class="st">"2021-08-15-MCU-ticket.csv"</span>).Film)</span>
<span id="cb3-4"><a href="#cb3-4"></a>W<span class="op">=</span>np.array(pd.read_csv(<span class="st">"2021-08-15-MCU-weights.csv"</span>,index_col<span class="op">=</span><span class="dv">0</span>))<span class="op">-</span>np.eye(n,n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scatter-plot" class="level3">
<h3 class="anchored" data-anchor-id="scatter-plot">scatter plot</h3>
<div id="cell-6" class="cell" data-execution_count="392">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>df<span class="op">=</span>pd.DataFrame({<span class="st">'V'</span>:V,<span class="st">'f'</span>:f,<span class="st">'in_degree'</span>:[<span class="bu">sum</span>(W[:,i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)],<span class="st">'out_degree'</span>:[<span class="bu">sum</span>(W[i,:]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]})</span>
<span id="cb4-2"><a href="#cb4-2"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="392">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">f</th>
<th data-quarto-table-cell-role="th">in_degree</th>
<th data-quarto-table-cell-role="th">out_degree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Iron Man</td>
<td>585.174222</td>
<td>2.515815</td>
<td>4.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>The Incredible Hulk</td>
<td>263.427551</td>
<td>0.294608</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Iron Man 2</td>
<td>623.933331</td>
<td>3.107363</td>
<td>4.153846</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Thor</td>
<td>449.326618</td>
<td>2.241890</td>
<td>2.562500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Captain America: The First Avenger</td>
<td>370.569774</td>
<td>0.948269</td>
<td>1.750000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="393">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>df[<span class="st">'type'</span>]<span class="op">=</span><span class="st">'SOLO/NOT-CORE'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell" data-execution_count="394">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>df.loc[<span class="bu">map</span>(<span class="kw">lambda</span> x: (<span class="st">"Iron Man"</span> <span class="kw">in</span> x) <span class="kw">or</span> (<span class="st">"Thor"</span> <span class="kw">in</span> x) <span class="kw">or</span> (<span class="st">"Captain America"</span> <span class="kw">in</span> x),df1.V),<span class="st">'type'</span>]<span class="op">=</span><span class="st">'SOLO/CORE'</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>df.loc[<span class="bu">map</span>(<span class="kw">lambda</span> x: (<span class="st">"Avengers"</span> <span class="kw">in</span> x) <span class="kw">or</span> (<span class="st">"Civil War"</span> <span class="kw">in</span> x),df1.V),<span class="st">'type'</span>]<span class="op">=</span><span class="st">'MULTI'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-execution_count="395">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="395">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">f</th>
<th data-quarto-table-cell-role="th">in_degree</th>
<th data-quarto-table-cell-role="th">out_degree</th>
<th data-quarto-table-cell-role="th">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Iron Man</td>
<td>585.174222</td>
<td>2.515815</td>
<td>4.000000</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>The Incredible Hulk</td>
<td>263.427551</td>
<td>0.294608</td>
<td>1.000000</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Iron Man 2</td>
<td>623.933331</td>
<td>3.107363</td>
<td>4.153846</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Thor</td>
<td>449.326618</td>
<td>2.241890</td>
<td>2.562500</td>
<td>SOLO/CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Captain America: The First Avenger</td>
<td>370.569774</td>
<td>0.948269</td>
<td>1.750000</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>The Avengers</td>
<td>1518.812988</td>
<td>4.332114</td>
<td>4.647059</td>
<td>MULTI</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Iron Man 3</td>
<td>1214.811252</td>
<td>1.690351</td>
<td>3.200000</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Thor: The Dark World</td>
<td>644.571402</td>
<td>2.147921</td>
<td>2.411765</td>
<td>SOLO/CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Captain America: The Winter Soldier</td>
<td>714.264267</td>
<td>2.455757</td>
<td>3.266667</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Guardians of the Galaxy</td>
<td>773.328629</td>
<td>1.212075</td>
<td>1.631579</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Avengers: Age of Ultron</td>
<td>1405.403694</td>
<td>4.428065</td>
<td>3.952381</td>
<td>MULTI</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Ant-man</td>
<td>519.311965</td>
<td>1.096071</td>
<td>1.750000</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Captain America: Civil War</td>
<td>1153.304495</td>
<td>4.048106</td>
<td>3.500000</td>
<td>MULTI</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Doctor Strange</td>
<td>677.718395</td>
<td>0.182711</td>
<td>0.857143</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Guardians of the Galaxy Vol 2</td>
<td>863.756051</td>
<td>0.898435</td>
<td>1.190476</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Spider-man: Homecoming</td>
<td>880.166924</td>
<td>2.416100</td>
<td>1.913043</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Thor: Ragnarok</td>
<td>853.977126</td>
<td>1.682512</td>
<td>2.285714</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Black Panther</td>
<td>1346.913161</td>
<td>0.582001</td>
<td>1.142857</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Avengers: Infinity War</td>
<td>2048.359754</td>
<td>7.545470</td>
<td>3.589744</td>
<td>MULTI</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Ant-man and the Wasp</td>
<td>622.674139</td>
<td>0.875455</td>
<td>1.000000</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Captain Marvel</td>
<td>1128.274794</td>
<td>0.926001</td>
<td>1.333333</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Avengers: Endgame</td>
<td>2796.274401</td>
<td>8.935337</td>
<td>3.120000</td>
<td>MULTI</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Spider-man: Far From Home</td>
<td>1131.026557</td>
<td>1.633182</td>
<td>1.937500</td>
<td>SOLO/NOT-CORE</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="396">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>fig <span class="op">=</span> ggplot(df) </span>
<span id="cb8-2"><a href="#cb8-2"></a>a1<span class="op">=</span> aes(x<span class="op">=</span><span class="st">'in_degree'</span>,y<span class="op">=</span><span class="st">'out_degree'</span>,size<span class="op">=</span><span class="st">'f'</span>,color<span class="op">=</span><span class="st">'type'</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>a2<span class="op">=</span> aes(x<span class="op">=</span><span class="st">'in_degree'</span>,y<span class="op">=</span><span class="st">'out_degree'</span>,label<span class="op">=</span><span class="st">'V'</span>,color<span class="op">=</span><span class="st">'type'</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>point1<span class="op">=</span> geom_point(a1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-execution_count="397">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>p1<span class="op">=</span>fig<span class="op">+</span>point1<span class="op">\</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="op">+</span>xlab(<span class="st">"In-degree"</span>)<span class="op">+</span>ylab(<span class="st">"Out-degree"</span>)<span class="op">\</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="op">+</span>geom_text(a2)<span class="op">+</span>theme_minimal()</span>
<span id="cb9-4"><a href="#cb9-4"></a>p1<span class="op">=</span>p1.draw()</span>
<span id="cb9-5"><a href="#cb9-5"></a>p1.set_figheight(<span class="dv">7</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a>p1.set_figwidth(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="398">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>adjust_text(p1.axes[<span class="dv">0</span>].texts,ax<span class="op">=</span>p1.axes[<span class="dv">0</span>], arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span><span class="st">'gray'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="398">
<pre><code>500</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 432x288 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="399">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="399">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hst" class="level3">
<h3 class="anchored" data-anchor-id="hst">HST</h3>
<div id="cell-15" class="cell" data-execution_count="650">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>gs<span class="op">=</span>GraphSignal(V,W,f)</span>
<span id="cb14-2"><a href="#cb14-2"></a>hst<span class="op">=</span>HeavysnowTransform(gs)</span>
<span id="cb14-3"><a href="#cb14-3"></a>hst.snow(tau<span class="op">=</span><span class="dv">20000</span>,b<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>HST (tau= 20000, b=1)
20000/20000
HST completed and all history is recorded.</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="651">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>plt.plot(hst.snowygrounds[:,<span class="dv">0</span>])</span>
<span id="cb16-2"><a href="#cb16-2"></a>plt.plot(hst.snowygrounds[:,<span class="dv">2000</span>])</span>
<span id="cb16-3"><a href="#cb16-3"></a>plt.plot(hst.snowygrounds[:,<span class="dv">20000</span>])</span>
<span id="cb16-4"><a href="#cb16-4"></a>plt.plot(hst.snowygrounds[:,<span class="dv">40000</span>])</span>
<span id="cb16-5"><a href="#cb16-5"></a>plt.plot(hst.snowygrounds[:,<span class="dv">60000</span>])</span>
<span id="cb16-6"><a href="#cb16-6"></a>plt.plot(hst.snowygrounds[:,<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: index 40000 is out of bounds for axis 1 with size 20001</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-13-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="spectral-analysis" class="level3">
<h3 class="anchored" data-anchor-id="spectral-analysis">Spectral analysis</h3>
<div id="cell-18" class="cell" data-execution_count="813">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="op">%</span>run heavysnow</span>
<span id="cb18-2"><a href="#cb18-2"></a>gs<span class="op">=</span>GraphSignal(V,hst.snowweight,f)</span>
<span id="cb18-3"><a href="#cb18-3"></a>spa<span class="op">=</span>SpectralAnalysis(gs)</span>
<span id="cb18-4"><a href="#cb18-4"></a>spa.graphFouriertransform()</span>
<span id="cb18-5"><a href="#cb18-5"></a>spa.decompose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell" data-tags="[]" data-execution_count="814">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">def</span> choose_theta(maxtheta<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb19-2"><a href="#cb19-2"></a>    y<span class="op">=</span>[]</span>
<span id="cb19-3"><a href="#cb19-3"></a>    x<span class="op">=</span>np.arange(start<span class="op">=</span><span class="fl">0.01</span>,stop<span class="op">=</span>maxtheta,step<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)):</span>
<span id="cb19-5"><a href="#cb19-5"></a>        hst.adjustingtheta(x[i]) </span>
<span id="cb19-6"><a href="#cb19-6"></a>        gs<span class="op">=</span>GraphSignal(V,hst.snowweight,f)</span>
<span id="cb19-7"><a href="#cb19-7"></a>        spa<span class="op">=</span>SpectralAnalysis(gs)</span>
<span id="cb19-8"><a href="#cb19-8"></a>        spa.graphFouriertransform()</span>
<span id="cb19-9"><a href="#cb19-9"></a>        spa.decompose()        </span>
<span id="cb19-10"><a href="#cb19-10"></a>        y.append(<span class="bu">sum</span>(<span class="bu">abs</span>(spa.lamb)<span class="op">&lt;</span><span class="fl">0.001</span>))</span>
<span id="cb19-11"><a href="#cb19-11"></a>    plt.plot(x,y)</span>
<span id="cb19-12"><a href="#cb19-12"></a>choose_theta()   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/cgb3/Dropbox/01_yechan/_notebooks/heavysnow.py:11: RuntimeWarning: invalid value encountered in true_divide</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-15-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="667">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="bu">abs</span>(spa.fbar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="667">
<pre><code>array([ 113.82693976,   69.1874798 ,  111.44376896,  120.73111873,
         27.31894564,   28.72744563,   18.9015293 ,  129.94958627,
         23.58492009,  117.97292179,   44.70789371,  257.06854198,
        389.82856746,  234.97154632,  296.21620356, 1134.27156442,
          4.21826872, 1321.97934777,  212.13470331, 3727.64704919,
        686.79172621, 1947.68808622, 2796.274401  ])</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="671">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>hst.adjustingtheta(<span class="dv">100</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>gs<span class="op">=</span>GraphSignal(V,hst.snowweight,f)</span>
<span id="cb23-3"><a href="#cb23-3"></a>spa<span class="op">=</span>SpectralAnalysis(gs)</span>
<span id="cb23-4"><a href="#cb23-4"></a>spa.graphFouriertransform()</span>
<span id="cb23-5"><a href="#cb23-5"></a>spa.decompose() </span>
<span id="cb23-6"><a href="#cb23-6"></a>plt.plot(spa.lamb,<span class="bu">abs</span>(spa.fbar),<span class="st">'.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="675">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="bu">abs</span>(spa.fbar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="675">
<pre><code>array([ 113.82693976,   69.1874798 ,  111.44376896,  120.73111873,
         27.31894564,   28.72744563,   18.9015293 ,  129.94958627,
         23.58492009,  117.97292179,   44.70789371,  257.06854198,
        389.82856746,  234.97154632,  296.21620356, 1134.27156442,
          4.21826872, 1321.97934777,  212.13470331, 3727.64704919,
        686.79172621, 1947.68808622, 2796.274401  ])</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="676">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>fig, axs<span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>) </span>
<span id="cb26-2"><a href="#cb26-2"></a>axs[<span class="dv">0</span>].imshow(hst.euclidweight)</span>
<span id="cb26-3"><a href="#cb26-3"></a>axs[<span class="dv">1</span>].imshow(hst.snowweight)</span>
<span id="cb26-4"><a href="#cb26-4"></a>axs[<span class="dv">2</span>].imshow(hst.graphweight)</span>
<span id="cb26-5"><a href="#cb26-5"></a>fig.set_figwidth(<span class="dv">15</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a>fig.set_figheight(<span class="dv">10</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="792">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>_a <span class="op">=</span> pd.DataFrame({<span class="st">'lambda_i'</span>:spa.lamb}).reset_index().rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'comp'</span>})</span>
<span id="cb27-2"><a href="#cb27-2"></a>_b <span class="op">=</span> pd.DataFrame(spa.components).stack().reset_index().rename(columns<span class="op">=</span>{<span class="st">'level_0'</span>:<span class="st">'Vindex'</span>,<span class="st">'level_1'</span>:<span class="st">'comp'</span>,<span class="dv">0</span>:<span class="st">'fbar'</span>})</span>
<span id="cb27-3"><a href="#cb27-3"></a>_ <span class="op">=</span> pd.merge(_a,_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-25" class="cell" data-execution_count="801">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>df2 <span class="op">=</span>_.assign(comp<span class="op">=</span><span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: spa.n<span class="op">-</span>x, _.comp))).merge(pd.DataFrame({<span class="st">'V'</span>:df.V,<span class="st">'Vindex'</span>:<span class="bu">range</span>(spa.n),<span class="st">'fill'</span>:df.<span class="bu">type</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-26" class="cell" data-execution_count="802">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="802">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">comp</th>
<th data-quarto-table-cell-role="th">lambda_i</th>
<th data-quarto-table-cell-role="th">Vindex</th>
<th data-quarto-table-cell-role="th">fbar</th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">fill</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>23</td>
<td>1.648869e+00</td>
<td>0</td>
<td>-1.670024e-02</td>
<td>Iron Man</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>22</td>
<td>1.502045e+00</td>
<td>0</td>
<td>-1.013031e-14</td>
<td>Iron Man</td>
<td>SOLO/CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>21</td>
<td>1.422011e+00</td>
<td>0</td>
<td>8.004475e-02</td>
<td>Iron Man</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>20</td>
<td>1.408156e+00</td>
<td>0</td>
<td>7.656253e-03</td>
<td>Iron Man</td>
<td>SOLO/CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>19</td>
<td>1.394609e+00</td>
<td>0</td>
<td>-1.093432e-05</td>
<td>Iron Man</td>
<td>SOLO/CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">524</td>
<td>5</td>
<td>1.182634e-03</td>
<td>22</td>
<td>0.000000e+00</td>
<td>Spider-man: Far From Home</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">525</td>
<td>4</td>
<td>1.351494e-05</td>
<td>22</td>
<td>0.000000e+00</td>
<td>Spider-man: Far From Home</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">526</td>
<td>3</td>
<td>5.897675e-17</td>
<td>22</td>
<td>0.000000e+00</td>
<td>Spider-man: Far From Home</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">527</td>
<td>2</td>
<td>2.975736e-17</td>
<td>22</td>
<td>1.131027e+03</td>
<td>Spider-man: Far From Home</td>
<td>SOLO/NOT-CORE</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">528</td>
<td>1</td>
<td>0.000000e+00</td>
<td>22</td>
<td>0.000000e+00</td>
<td>Spider-man: Far From Home</td>
<td>SOLO/NOT-CORE</td>
</tr>
</tbody>
</table>

<p>529 rows × 6 columns</p>
</div>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="810">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>ggplot(df2)<span class="op">+</span>facet_wrap(<span class="st">'comp'</span>)<span class="op">+</span>geom_col(aes(x<span class="op">=</span><span class="st">'Vindex'</span>,y<span class="op">=</span><span class="st">'fbar'</span>,fill<span class="op">=</span><span class="st">'fill'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="812">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>plt.plot(df2.query(<span class="st">" V=='Avengers: Infinity War' "</span>)[<span class="st">'fbar'</span>],<span class="st">'.'</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>df2.query(<span class="st">" V=='Avengers: Infinity War' "</span>)[<span class="st">'fbar'</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="812">
<pre><code>2048.359754000001</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-24-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="811">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="811">
<pre><code>array([ 585.174222,  263.427551,  623.933331,  449.326618,  370.569774,
       1518.812988, 1214.811252,  644.571402,  714.264267,  773.328629,
       1405.403694,  519.311965, 1153.304495,  677.718395,  863.756051,
        880.166924,  853.977126, 1346.913161, 2048.359754,  622.674139,
       1128.274794, 2796.274401, 1131.026557])</code></pre>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="805">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>fig<span class="op">=</span>ggplot(df2)</span>
<span id="cb35-2"><a href="#cb35-2"></a>facet<span class="op">=</span>facet_wrap(<span class="st">'comp'</span>,ncol<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a>a1<span class="op">=</span>aes(x<span class="op">=</span><span class="st">'Vindex'</span>,y<span class="op">=</span><span class="st">'fbar'</span>,fill<span class="op">=</span><span class="st">'fill'</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a>a2<span class="op">=</span>aes(x<span class="op">=</span><span class="st">'Vindex'</span>,y<span class="op">=</span><span class="st">'fbar'</span>,label<span class="op">=</span><span class="st">'V'</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a>col<span class="op">=</span>geom_col(a1,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb35-6"><a href="#cb35-6"></a>hline<span class="op">=</span>geom_hline(yintercept<span class="op">=</span><span class="dv">0</span>,linetype<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'gray'</span>,size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a>p2<span class="op">=</span>fig<span class="op">+</span>facet<span class="op">\</span></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="op">+</span>geom_col(a1)<span class="op">\</span></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="op">+</span>geom_hline(yintercept<span class="op">=</span><span class="dv">0</span>,linetype<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'gray'</span>)<span class="op">\</span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="op">+</span>theme(figure_size<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">100</span>))<span class="op">\</span></span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="op">+</span>geom_text(a2)</span>
<span id="cb35-13"><a href="#cb35-13"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="유클리드와-그래프도메인의-정보를-플랏." class="level3">
<h3 class="anchored" data-anchor-id="유클리드와-그래프도메인의-정보를-플랏.">유클리드와 그래프도메인의 정보를 플랏.</h3>
<div id="cell-32" class="cell" data-execution_count="599">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a><span class="op">%</span>R <span class="op">-</span>i f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-33" class="cell" data-execution_count="600">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>WW <span class="op">=</span>hst.snowweight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-34" class="cell" data-execution_count="601">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="op">%</span>R <span class="op">-</span>i WW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-execution_count="610">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a><span class="op">%%</span>R </span>
<span id="cb39-2"><a href="#cb39-2"></a>degree<span class="op">&lt;-</span>function(W){</span>
<span id="cb39-3"><a href="#cb39-3"></a>    diag(<span class="bu">apply</span>(W,<span class="dv">1</span>,<span class="bu">sum</span>))</span>
<span id="cb39-4"><a href="#cb39-4"></a>}</span>
<span id="cb39-5"><a href="#cb39-5"></a>degree_rootinv<span class="op">&lt;-</span>function(W){</span>
<span id="cb39-6"><a href="#cb39-6"></a>    d<span class="op">&lt;-</span><span class="bu">apply</span>(W,<span class="dv">1</span>,<span class="bu">sum</span>)</span>
<span id="cb39-7"><a href="#cb39-7"></a>    drootinv<span class="op">&lt;-</span>d</span>
<span id="cb39-8"><a href="#cb39-8"></a>    drootinv[d<span class="op">&gt;</span><span class="fl">0.01</span>]<span class="op">&lt;-</span>sqrt(<span class="dv">1</span><span class="op">/</span>d[d<span class="op">&gt;</span><span class="fl">0.01</span>])</span>
<span id="cb39-9"><a href="#cb39-9"></a>    diag(drootinv)</span>
<span id="cb39-10"><a href="#cb39-10"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-36" class="cell" data-execution_count="611">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="op">%%</span>R </span>
<span id="cb40-2"><a href="#cb40-2"></a>gfft<span class="op">&lt;-</span>function(f,W){</span>
<span id="cb40-3"><a href="#cb40-3"></a>    n<span class="op">&lt;-</span>length(f)</span>
<span id="cb40-4"><a href="#cb40-4"></a>    D<span class="op">&lt;-</span>degree(W)</span>
<span id="cb40-5"><a href="#cb40-5"></a>    D_rootinv<span class="op">&lt;-</span>degree_rootinv(W)</span>
<span id="cb40-6"><a href="#cb40-6"></a>    L<span class="op">&lt;-</span>D<span class="op">-</span>W</span>
<span id="cb40-7"><a href="#cb40-7"></a>    L_tilde<span class="op">&lt;-</span>D_rootinv<span class="op">%*%</span>L<span class="op">%*%</span>D_rootinv</span>
<span id="cb40-8"><a href="#cb40-8"></a>    svdrslt<span class="op">&lt;-</span>svd(L_tilde)</span>
<span id="cb40-9"><a href="#cb40-9"></a>    λ<span class="op">&lt;-</span>svdrslt$d</span>
<span id="cb40-10"><a href="#cb40-10"></a>    Λ<span class="op">&lt;-</span>diag(λ)</span>
<span id="cb40-11"><a href="#cb40-11"></a>    U<span class="op">&lt;-</span>svdrslt$u<span class="op">;</span> </span>
<span id="cb40-12"><a href="#cb40-12"></a>    V<span class="op">&lt;-</span>svdrslt$v<span class="op">;</span> </span>
<span id="cb40-13"><a href="#cb40-13"></a>    Ψ<span class="op">&lt;-</span>U</span>
<span id="cb40-14"><a href="#cb40-14"></a>    <span class="co">## reconstruction: L_tilde &lt;- U%*%Lamb*t(V) or L_tilde &lt;- Psi%*%Lamb*t(Psi)</span></span>
<span id="cb40-15"><a href="#cb40-15"></a>    fbar<span class="op">&lt;-</span><span class="im">as</span>.vector(t(Ψ)<span class="op">%*%</span>f) <span class="co">## fhat is Fourier Transform of f. </span></span>
<span id="cb40-16"><a href="#cb40-16"></a>    <span class="bu">list</span>(λ<span class="op">=</span>λ,Ψ<span class="op">=</span>Ψ,fbar<span class="op">=</span>fbar)</span>
<span id="cb40-17"><a href="#cb40-17"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-37" class="cell" data-execution_count="612">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="op">%%</span>R </span>
<span id="cb41-2"><a href="#cb41-2"></a>Psi<span class="op">=</span>gfft(f,WW)$Ψ</span>
<span id="cb41-3"><a href="#cb41-3"></a>lamb<span class="op">=</span>gfft(f,WW)$λ</span>
<span id="cb41-4"><a href="#cb41-4"></a>fbar<span class="op">=</span>gfft(f,WW)$fbar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-38" class="cell" data-execution_count="613">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="op">%</span>R <span class="op">-</span>o Psi </span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="op">%</span>R <span class="op">-</span>o lamb </span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="op">%</span>R <span class="op">-</span>o fbar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-39" class="cell" data-execution_count="614">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="op">%%</span>R </span>
<span id="cb43-2"><a href="#cb43-2"></a>A<span class="op">=</span>rbind(c(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>),c(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>),c(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>),c(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-3"><a href="#cb43-3"></a>svd(L_tilde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$d
 [1]  2.000000e+00  2.000000e+00  2.220446e-16  1.251279e-71  2.072649e-87
 [6] 3.094230e-204 3.094230e-204  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[16]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[21]  0.000000e+00  0.000000e+00  0.000000e+00

$u
            [,1]           [,2]       [,3]       [,4]       [,5]           [,6]
 [1,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
 [2,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
 [3,]  0.0000000  -7.071068e-01  0.0000000  0.0000000  0.0000000 -1.995229e-204
 [4,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
 [5,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
 [6,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
 [7,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
 [8,]  0.0000000  1.542089e-204  0.0000000  0.0000000  0.0000000  -1.000000e+00
 [9,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[10,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[11,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[12,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[13,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[14,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[15,]  0.0000000   0.000000e+00  0.0000000  0.7071068 -0.7071068   0.000000e+00
[16,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[17,]  0.0000000   0.000000e+00  0.0000000 -0.7071068 -0.7071068   0.000000e+00
[18,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[19,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[20,]  0.0000000   7.071068e-01  0.0000000  0.0000000  0.0000000  1.856148e-205
[21,] -0.7071068   0.000000e+00 -0.7071068  0.0000000  0.0000000   0.000000e+00
[22,]  0.0000000   0.000000e+00  0.0000000  0.0000000  0.0000000   0.000000e+00
[23,]  0.7071068   0.000000e+00 -0.7071068  0.0000000  0.0000000   0.000000e+00
                [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15]
 [1,]   0.000000e+00    0    0     0     0     0     0     0     0
 [2,]   0.000000e+00    0    0     0     0     0     0     0     0
 [3,]   7.071068e-01    0    0     0     0     0     0     0     0
 [4,]   0.000000e+00    0    0     0     0     0     0     0     0
 [5,]   0.000000e+00    0    0     0     0     0     1     0     0
 [6,]   0.000000e+00    0    0     0     0     0     0     0     0
 [7,]   0.000000e+00    0    0     0     0     0     0     0     0
 [8,] -1.279590e-204    0    0     0     0     0     0     0     0
 [9,]   0.000000e+00    0    0     0     0     0     0     0     0
[10,]   0.000000e+00    0    0     0     0     0     0     0     0
[11,]   0.000000e+00    1    0     0     0     0     0     0     0
[12,]   0.000000e+00    0    1     0     0     0     0     0     0
[13,]   0.000000e+00    0    0     0     0     0     0     0     0
[14,]   0.000000e+00    0    0     0     0     0     0    -1     0
[15,]   0.000000e+00    0    0     0     0     0     0     0     0
[16,]   0.000000e+00    0    0    -1     0     0     0     0     0
[17,]   0.000000e+00    0    0     0     0     0     0     0     0
[18,]   0.000000e+00    0    0     0     1     0     0     0     0
[19,]   0.000000e+00    0    0     0     0     1     0     0     0
[20,]   7.071068e-01    0    0     0     0     0     0     0     0
[21,]   0.000000e+00    0    0     0     0     0     0     0     0
[22,]   0.000000e+00    0    0     0     0     0     0     0     1
[23,]   0.000000e+00    0    0     0     0     0     0     0     0
              [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]
 [1,]  0.000000e+00     0     0     0     0     0     0     1
 [2,]  0.000000e+00     0     0     0     0     0     1     0
 [3,]  0.000000e+00     0     0     0     0     0     0     0
 [4,]  0.000000e+00     0     0    -1     0     0     0     0
 [5,]  0.000000e+00     0     0     0     0     0     0     0
 [6,]  0.000000e+00     0     0     0     0     1     0     0
 [7,]  0.000000e+00     0     0     0     1     0     0     0
 [8,]  0.000000e+00     0     0     0     0     0     0     0
 [9,]  0.000000e+00     0     1     0     0     0     0     0
[10,]  0.000000e+00     1     0     0     0     0     0     0
[11,]  0.000000e+00     0     0     0     0     0     0     0
[12,]  0.000000e+00     0     0     0     0     0     0     0
[13,]  1.000000e+00     0     0     0     0     0     0     0
[14,]  0.000000e+00     0     0     0     0     0     0     0
[15,]  0.000000e+00     0     0     0     0     0     0     0
[16,]  0.000000e+00     0     0     0     0     0     0     0
[17,]  0.000000e+00     0     0     0     0     0     0     0
[18,]  0.000000e+00     0     0     0     0     0     0     0
[19,]  0.000000e+00     0     0     0     0     0     0     0
[20,]  0.000000e+00     0     0     0     0     0     0     0
[21,] -1.295618e-33     0     0     0     0     0     0     0
[22,]  0.000000e+00     0     0     0     0     0     0     0
[23,]  0.000000e+00     0     0     0     0     0     0     0

$v
                [,1]           [,2]           [,3]          [,4]          [,5]
 [1,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
 [2,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
 [3,]   0.000000e+00  -7.071068e-01   0.000000e+00  0.000000e+00  0.000000e+00
 [4,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
 [5,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
 [6,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
 [7,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
 [8,]   0.000000e+00  1.542089e-204   0.000000e+00  0.000000e+00  0.000000e+00
 [9,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
[10,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
[11,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
[12,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
[13,] -1.175703e-267   0.000000e+00  1.058979e-251  0.000000e+00  0.000000e+00
[14,]   0.000000e+00   0.000000e+00  -1.000000e+00  1.570092e-16  2.453269e-18
[15,]   0.000000e+00   0.000000e+00   0.000000e+00  7.071068e-01  2.080627e-02
[16,]   0.000000e+00   0.000000e+00   0.000000e+00  1.110223e-16  9.995670e-01
[17,]   0.000000e+00   0.000000e+00   0.000000e+00 -7.071068e-01  2.080627e-02
[18,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
[19,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
[20,]   0.000000e+00   7.071068e-01   0.000000e+00  0.000000e+00  0.000000e+00
[21,]  -7.071068e-01   0.000000e+00  -1.110223e-16  2.465190e-32  3.851860e-34
[22,]   0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00  0.000000e+00
[23,]   7.071068e-01   0.000000e+00   1.110223e-16 -2.465190e-32 -3.851860e-34
               [,6]           [,7] [,8] [,9]         [,10] [,11] [,12]
 [1,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
 [2,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
 [3,]  7.071068e-01   0.000000e+00    0    0  0.000000e+00     0     0
 [4,]  0.000000e+00  2.180843e-204    0    0  0.000000e+00     0     0
 [5,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
 [6,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
 [7,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
 [8,] 1.542089e-204  -1.000000e+00    0    0  0.000000e+00     0     0
 [9,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
[10,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
[11,]  0.000000e+00   0.000000e+00    1    0  0.000000e+00     0     0
[12,]  0.000000e+00   0.000000e+00    0    1  0.000000e+00     0     0
[13,]  0.000000e+00   0.000000e+00    0    0  1.000000e+00     0     0
[14,]  0.000000e+00   0.000000e+00    0    0 1.058979e-251     0     0
[15,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
[16,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
[17,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
[18,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     1     0
[19,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     1
[20,]  7.071068e-01  2.180843e-204    0    0  0.000000e+00     0     0
[21,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
[22,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
[23,]  0.000000e+00   0.000000e+00    0    0  0.000000e+00     0     0
               [,13]       [,14] [,15]       [,16] [,17] [,18] [,19] [,20]
 [1,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
 [2,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
 [3,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
 [4,]  -1.000000e+00  0.00000000     0  0.00000000     0     0     0     0
 [5,]   0.000000e+00  0.00000000     0  0.00000000     0     0     1     0
 [6,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
 [7,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     1
 [8,] -2.180843e-204  0.00000000     0  0.00000000     0     0     0     0
 [9,]   0.000000e+00  0.00000000     0  0.00000000     0     1     0     0
[10,]   0.000000e+00  0.00000000     0  0.00000000     1     0     0     0
[11,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
[12,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
[13,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
[14,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
[15,]   0.000000e+00  0.49978350     0 -0.49978350     0     0     0     0
[16,]   0.000000e+00 -0.02080627     0  0.02080627     0     0     0     0
[17,]   0.000000e+00  0.49978350     0 -0.49978350     0     0     0     0
[18,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
[19,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
[20,]   0.000000e+00  0.00000000     0  0.00000000     0     0     0     0
[21,]   0.000000e+00  0.50000000     0  0.50000000     0     0     0     0
[22,]   0.000000e+00  0.00000000     1  0.00000000     0     0     0     0
[23,]   0.000000e+00  0.50000000     0  0.50000000     0     0     0     0
      [,21] [,22] [,23]
 [1,]     0     0     1
 [2,]     0     1     0
 [3,]     0     0     0
 [4,]     0     0     0
 [5,]     0     0     0
 [6,]     1     0     0
 [7,]     0     0     0
 [8,]     0     0     0
 [9,]     0     0     0
[10,]     0     0     0
[11,]     0     0     0
[12,]     0     0     0
[13,]     0     0     0
[14,]     0     0     0
[15,]     0     0     0
[16,]     0     0     0
[17,]     0     0     0
[18,]     0     0     0
[19,]     0     0     0
[20,]     0     0     0
[21,]     0     0     0
[22,]     0     0     0
[23,]     0     0     0
</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="615">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>np.linalg.svd(spa.Lz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="615">
<pre><code>(array([[ 8.31802845e-07, -2.28244345e-02,  1.69005964e-05,
          8.32458517e-05,  1.37445367e-03, -1.69822716e-03,
         -2.72169523e-04,  1.62367170e-01,  1.00120612e-01,
          7.87048705e-01,  2.28051493e-03,  1.30702273e-01,
         -2.37071773e-01, -1.52905997e-02,  2.00695093e-01,
          2.67355662e-01, -2.13953115e-01,  1.09902642e-01,
          7.86967503e-02, -1.48612089e-01, -2.68747745e-01,
          1.30686848e-15,  0.00000000e+00],
        [-1.73745237e-07,  5.82817056e-01,  3.19679606e-06,
          1.95527208e-05, -4.01026817e-04,  1.79423330e-03,
          1.42218015e-03, -2.93595666e-01, -1.03797754e-02,
          1.14069591e-01,  6.91273124e-04,  4.16978017e-02,
         -8.86891483e-02, -1.23071410e-02,  2.91466972e-01,
         -4.03091203e-01,  4.10097210e-01,  3.04233036e-01,
          1.72107925e-01, -5.85142438e-02, -1.00131938e-01,
          4.86771502e-16,  0.00000000e+00],
        [ 1.79945470e-06, -8.86372067e-03, -1.04110175e-05,
         -9.71301027e-06,  4.57105960e-03, -4.80419733e-03,
         -1.70253832e-03,  6.84489722e-02, -8.94572257e-02,
         -3.62195685e-01,  7.07057922e-01, -8.91235662e-02,
         -3.08771296e-01, -1.43439358e-02,  2.87180479e-01,
          1.38574486e-03, -2.50779597e-01,  5.25321979e-02,
          4.62662964e-02, -1.53603086e-01, -2.80575388e-01,
          1.27474638e-15,  0.00000000e+00],
        [-3.81405817e-07,  3.49123335e-01, -1.13849656e-05,
         -5.20669020e-05,  1.71456172e-03, -4.55458198e-03,
         -3.23802030e-03,  6.03887632e-01,  1.59324493e-02,
         -1.71482299e-01, -1.01439208e-03, -6.13090187e-02,
          1.29497547e-01,  1.64717834e-02, -3.63078784e-01,
          3.19851736e-01,  2.19096359e-01,  3.13539902e-01,
          1.85056706e-01, -1.08809944e-01, -1.90814734e-01,
          9.28237485e-16,  0.00000000e+00],
        [ 3.16749182e-07, -7.33268982e-01, -5.84182485e-07,
         -5.10615468e-06,  1.76538169e-05, -3.21602859e-04,
         -2.73625670e-04,  5.32095578e-02,  8.79091764e-04,
         -4.98735345e-03, -2.44886069e-05, -1.33381519e-03,
          2.20628230e-03, -9.51433687e-04,  4.34514775e-02,
         -1.84099352e-01,  4.42865286e-01,  3.83729129e-01,
          2.19747367e-01, -8.96443849e-02, -1.54818075e-01,
          7.52880680e-16,  0.00000000e+00],
        [-4.21211716e-01, -1.26228933e-06,  9.91140473e-03,
          1.05442602e-01, -2.34738842e-02,  8.53928708e-02,
         -4.37304704e-01, -1.81877637e-03, -1.21592942e-02,
          3.22860569e-03,  1.99130400e-04,  6.87072180e-03,
         -8.67943385e-03,  5.85421891e-01,  2.28593792e-02,
          3.80026942e-03,  1.21361156e-02, -2.35507433e-01,
          4.01787503e-01,  2.04572687e-01, -9.92561433e-02,
          5.47220932e-16,  0.00000000e+00],
        [ 7.57297687e-02, -6.30483358e-06,  3.91285206e-02,
          3.71727089e-01, -4.54039898e-02,  1.26342172e-01,
         -6.01054964e-01, -1.99193673e-03, -3.77249821e-04,
         -4.01709394e-04, -4.51319737e-05, -1.59359360e-03,
          2.37308481e-03, -5.22068979e-01, -2.88333379e-02,
         -8.70800118e-03, -1.75269179e-02,  9.61943777e-02,
         -1.21708705e-01,  3.73352537e-01, -1.94988884e-01,
          1.03622738e-15,  0.00000000e+00],
        [ 1.86543546e-06, -2.97029443e-03, -3.36972961e-05,
         -1.05359128e-04,  4.99362785e-03, -5.24357048e-03,
         -2.35731474e-03,  2.37200800e-02, -1.09617362e-01,
         -6.16365153e-02,  1.42842702e-02,  5.07740516e-01,
          7.11653463e-01, -4.13443733e-03,  1.88246122e-01,
         -1.34691861e-01, -2.46561507e-01,  2.10092754e-02,
          2.76205858e-02, -1.53692883e-01, -2.82641870e-01,
          1.37503249e-15,  0.00000000e+00],
        [-7.99573985e-06,  3.95206738e-03, -6.27063562e-05,
         -3.92509820e-04, -1.69919218e-02,  1.62054211e-02,
          2.80023428e-03, -4.07149823e-02,  6.87137136e-01,
         -6.93247574e-02,  7.38886061e-03,  2.21976985e-01,
         -1.87390215e-01,  2.61529015e-02, -4.24713135e-01,
         -3.69548565e-01, -1.14035532e-01, -9.97472687e-02,
         -4.81725917e-02, -1.41761537e-01, -2.70847893e-01,
          1.31690350e-15,  0.00000000e+00],
        [-3.95062745e-05,  1.57431046e-03,  4.06604890e-04,
          1.18991491e-03, -7.33907458e-02,  7.64563613e-02,
          3.33175204e-02, -5.19933079e-03, -6.78035427e-01,
          1.21947194e-01,  6.51141842e-03,  2.21973929e-01,
         -2.57726712e-01,  5.74820600e-03, -4.45391431e-01,
         -2.23195140e-01,  9.46570807e-02, -2.15389710e-01,
         -1.24586624e-01, -1.23608317e-01, -2.50818380e-01,
          1.21581416e-15,  0.00000000e+00],
        [ 7.42676668e-01,  1.32904594e-06, -3.99249712e-03,
         -3.94942827e-02,  7.34555531e-03, -2.26382886e-02,
          1.10541819e-01,  3.97233327e-04,  8.59303569e-04,
         -1.51619560e-04, -6.17706951e-06, -2.07405990e-04,
          2.05099427e-04,  4.74556551e-02,  3.47728873e-03,
          1.70086239e-03,  1.25454062e-02, -2.83772670e-01,
          4.90026906e-01,  2.99206276e-01, -1.46514769e-01,
          6.96183304e-16,  0.00000000e+00],
        [-3.90910918e-07, -6.36400071e-03,  2.21728059e-05,
          7.82229365e-05, -4.58350808e-03,  7.96250033e-03,
          4.65490914e-03, -7.12305097e-01, -1.02963001e-02,
         -9.01948826e-02, -2.89885212e-04, -2.39584007e-02,
          5.89179260e-02,  9.93604657e-03, -2.82526103e-01,
          5.16201870e-01, -3.87611918e-02,  2.09850059e-01,
          1.31822329e-01, -1.30288266e-01, -2.32190851e-01,
          1.12860186e-15,  0.00000000e+00],
        [ 4.19197158e-03, -3.33385384e-06, -3.37382216e-02,
         -8.28576687e-01,  5.81916530e-03,  3.00909739e-02,
         -1.88089877e-01, -1.03679492e-03, -6.50140854e-03,
          1.56416197e-03,  8.88984740e-05,  3.05321800e-03,
         -3.71410692e-03,  6.77143011e-02, -2.98911556e-03,
         -4.54139776e-03, -1.88890206e-02,  1.62808110e-01,
         -2.36446569e-01,  3.83251555e-01, -2.04088197e-01,
          1.02375742e-15,  0.00000000e+00],
        [-5.66982260e-08,  2.55064959e-03, -7.19961507e-05,
         -3.00326201e-04,  6.07234653e-04, -1.09077308e-03,
         -2.15658870e-03, -2.46346567e-02, -5.50520388e-02,
          1.96041569e-01, -2.69369204e-02, -7.77356097e-01,
          3.24311614e-01,  1.64295269e-02, -1.13776766e-01,
         -3.00731043e-01, -2.04937318e-01, -3.32171483e-02,
         -5.70435499e-03, -1.50080534e-01, -2.80031330e-01,
          1.36278202e-15,  0.00000000e+00],
        [ 4.10395438e-05, -3.13366217e-04,  8.14273566e-04,
          5.56447636e-03,  6.41222150e-01,  5.01569971e-01,
          5.62343554e-02,  4.95667053e-03,  8.51669174e-02,
         -2.04955771e-02, -1.19727187e-03, -4.10396061e-02,
          4.97920470e-02, -1.12808282e-02,  1.39500146e-01,
          1.47501547e-01,  3.11105818e-01, -3.04008474e-01,
         -1.92176972e-01, -9.10637927e-02, -2.15471294e-01,
          1.05080883e-15,  0.00000000e+00],
        [ 1.48848758e-04, -2.35982660e-04, -3.53800726e-03,
         -1.71372928e-02, -7.45851291e-01,  2.44486580e-01,
          8.56940821e-02,  1.15410572e-02,  1.31798247e-01,
         -3.31660885e-02, -1.86999343e-03, -6.43221718e-02,
          7.83897657e-02, -2.74666493e-03,  1.98432101e-01,
          1.79123088e-01,  3.17444893e-01, -2.97926254e-01,
         -1.92852034e-01, -8.18949588e-02, -2.06142479e-01,
          9.93177050e-16,  0.00000000e+00],
        [ 8.78543271e-07, -3.17838052e-04,  1.34421400e-03,
          6.78594911e-03,  1.51549473e-01, -8.02101418e-01,
         -1.75991858e-01, -8.06160106e-03,  4.14051119e-02,
         -8.94283673e-03, -5.89880091e-04, -2.01057558e-02,
          2.42119590e-02, -1.44689643e-02,  8.93288614e-02,
          1.20168864e-01,  3.01542324e-01, -3.03845431e-01,
         -1.89928235e-01, -9.58247486e-02, -2.20590883e-01,
          1.08307003e-15,  0.00000000e+00],
        [-5.14913484e-01,  4.18430716e-07, -9.80986052e-03,
         -1.03562437e-01,  2.24827063e-02, -8.16855839e-02,
          4.18037887e-01,  1.73339634e-03,  1.11731626e-02,
         -2.93783168e-03, -1.79887167e-04, -6.20431547e-03,
          7.81293050e-03, -4.94481358e-01, -1.81997957e-02,
         -1.90892495e-03,  5.98037592e-03, -2.06293518e-01,
          3.65843309e-01,  3.11017153e-01, -1.54468446e-01,
          6.89446812e-16,  0.00000000e+00],
        [-3.30872245e-24, -6.46234854e-27, -6.93889390e-18,
          3.46944695e-18, -3.46944695e-18, -2.77555756e-17,
          2.22044605e-16,  1.08420217e-19, -4.33680869e-19,
          2.16840434e-19, -2.49800181e-16,  0.00000000e+00,
         -8.67361738e-19,  2.71050543e-20,  2.11758237e-22,
         -1.55096365e-25, -1.03397577e-25, -9.92616735e-24,
          1.65436123e-23,  1.82641479e-21, -4.82947016e-15,
         -1.00000000e+00,  0.00000000e+00],
        [ 1.79531969e-06, -8.94842690e-03, -1.01546268e-05,
         -8.73262658e-06,  4.55614976e-03, -4.79156777e-03,
         -1.69335914e-03,  6.90829904e-02, -8.89583848e-02,
         -3.67777353e-01, -7.06420773e-01, -4.41061120e-02,
         -3.12741481e-01, -1.44351074e-02,  2.87782945e-01,
          3.18915913e-03, -2.50720746e-01,  5.29210854e-02,
          4.64923431e-02, -1.53587496e-01, -2.80525323e-01,
          1.45326093e-15,  0.00000000e+00],
        [-8.33021631e-03,  1.05962533e-05,  7.09113594e-01,
          2.40362541e-01,  1.65950319e-02, -6.45471772e-02,
          3.19056399e-01,  1.13629083e-03,  1.20076058e-04,
          2.58146832e-04,  2.73459895e-05,  9.63515224e-04,
         -1.41365588e-03,  2.63265400e-01,  1.27213549e-02,
          1.05603468e-03, -1.39706382e-02,  1.64799812e-01,
         -2.50268914e-01,  3.66433378e-01, -1.98337145e-01,
          9.19573780e-16,  0.00000000e+00],
        [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00, -1.00000000e+00],
        [-7.36022066e-03,  8.23867965e-06, -7.03038426e-01,
          3.06153537e-01,  1.79901928e-02, -5.91845158e-02,
          2.84078264e-01,  9.35442758e-04, -8.43705836e-04,
          4.66038804e-04,  3.80317664e-05,  1.32834008e-03,
         -1.83555043e-03,  2.48090528e-01,  1.10378059e-02,
          3.25080258e-04, -1.47079819e-02,  1.65391227e-01,
         -2.49763201e-01,  3.68918163e-01, -1.99236686e-01,
          9.21646644e-16,  0.00000000e+00]]),
 array([1.62354816e+00, 1.54316369e+00, 1.35756541e+00, 1.34448641e+00,
        1.31529137e+00, 1.29394024e+00, 1.28834537e+00, 1.27251369e+00,
        1.20017996e+00, 1.18789691e+00, 1.17953136e+00, 1.17909170e+00,
        1.17562417e+00, 1.11826799e+00, 1.07719638e+00, 8.87648300e-01,
        4.23129021e-01, 2.66322700e-01, 2.52463591e-01, 1.37935777e-02,
        2.83343727e-09, 1.11370076e-17, 0.00000000e+00]),
 array([[ 8.31802845e-07, -1.73745237e-07,  1.79945470e-06,
         -3.81405817e-07,  3.16749182e-07, -4.21211716e-01,
          7.57297687e-02,  1.86543546e-06, -7.99573985e-06,
         -3.95062745e-05,  7.42676668e-01, -3.90910918e-07,
          4.19197158e-03, -5.66982261e-08,  4.10395438e-05,
          1.48848758e-04,  8.78543271e-07, -5.14913484e-01,
          2.11758237e-22,  1.79531969e-06, -8.33021631e-03,
          0.00000000e+00, -7.36022066e-03],
        [-2.28244345e-02,  5.82817056e-01, -8.86372067e-03,
          3.49123335e-01, -7.33268982e-01, -1.26228933e-06,
         -6.30483358e-06, -2.97029443e-03,  3.95206738e-03,
          1.57431046e-03,  1.32904594e-06, -6.36400071e-03,
         -3.33385384e-06,  2.55064959e-03, -3.13366217e-04,
         -2.35982660e-04, -3.17838052e-04,  4.18430716e-07,
          0.00000000e+00, -8.94842690e-03,  1.05962533e-05,
          0.00000000e+00,  8.23867965e-06],
        [ 1.69005964e-05,  3.19679606e-06, -1.04110175e-05,
         -1.13849656e-05, -5.84182485e-07,  9.91140473e-03,
          3.91285206e-02, -3.36972961e-05, -6.27063562e-05,
          4.06604890e-04, -3.99249712e-03,  2.21728059e-05,
         -3.37382216e-02, -7.19961507e-05,  8.14273566e-04,
         -3.53800726e-03,  1.34421400e-03, -9.80986052e-03,
         -1.11022302e-16, -1.01546268e-05,  7.09113594e-01,
          0.00000000e+00, -7.03038426e-01],
        [ 8.32458517e-05,  1.95527208e-05, -9.71301027e-06,
         -5.20669020e-05, -5.10615468e-06,  1.05442602e-01,
          3.71727089e-01, -1.05359128e-04, -3.92509820e-04,
          1.18991491e-03, -3.94942827e-02,  7.82229365e-05,
         -8.28576687e-01, -3.00326201e-04,  5.56447636e-03,
         -1.71372928e-02,  6.78594911e-03, -1.03562437e-01,
          5.55111512e-17, -8.73262658e-06,  2.40362541e-01,
          0.00000000e+00,  3.06153537e-01],
        [ 1.37445367e-03, -4.01026817e-04,  4.57105960e-03,
          1.71456172e-03,  1.76538169e-05, -2.34738842e-02,
         -4.54039898e-02,  4.99362785e-03, -1.69919218e-02,
         -7.33907458e-02,  7.34555531e-03, -4.58350808e-03,
          5.81916530e-03,  6.07234653e-04,  6.41222150e-01,
         -7.45851291e-01,  1.51549473e-01,  2.24827063e-02,
          0.00000000e+00,  4.55614976e-03,  1.65950319e-02,
          0.00000000e+00,  1.79901928e-02],
        [-1.69822716e-03,  1.79423330e-03, -4.80419733e-03,
         -4.55458198e-03, -3.21602859e-04,  8.53928708e-02,
          1.26342172e-01, -5.24357048e-03,  1.62054211e-02,
          7.64563613e-02, -2.26382886e-02,  7.96250033e-03,
          3.00909739e-02, -1.09077308e-03,  5.01569971e-01,
          2.44486580e-01, -8.02101418e-01, -8.16855839e-02,
         -2.77555756e-17, -4.79156777e-03, -6.45471772e-02,
          0.00000000e+00, -5.91845158e-02],
        [-2.72169523e-04,  1.42218015e-03, -1.70253832e-03,
         -3.23802030e-03, -2.73625670e-04, -4.37304704e-01,
         -6.01054964e-01, -2.35731474e-03,  2.80023428e-03,
          3.33175204e-02,  1.10541819e-01,  4.65490914e-03,
         -1.88089877e-01, -2.15658870e-03,  5.62343554e-02,
          8.56940821e-02, -1.75991858e-01,  4.18037887e-01,
          2.08166817e-17, -1.69335914e-03,  3.19056399e-01,
          0.00000000e+00,  2.84078264e-01],
        [ 1.62367170e-01, -2.93595666e-01,  6.84489722e-02,
          6.03887632e-01,  5.32095578e-02, -1.81877637e-03,
         -1.99193673e-03,  2.37200800e-02, -4.07149823e-02,
         -5.19933079e-03,  3.97233327e-04, -7.12305097e-01,
         -1.03679492e-03, -2.46346567e-02,  4.95667053e-03,
          1.15410572e-02, -8.06160106e-03,  1.73339634e-03,
          0.00000000e+00,  6.90829904e-02,  1.13629083e-03,
          0.00000000e+00,  9.35442758e-04],
        [ 1.00120612e-01, -1.03797754e-02, -8.94572257e-02,
          1.59324493e-02,  8.79091764e-04, -1.21592942e-02,
         -3.77249821e-04, -1.09617362e-01,  6.87137136e-01,
         -6.78035427e-01,  8.59303569e-04, -1.02963001e-02,
         -6.50140854e-03, -5.50520388e-02,  8.51669174e-02,
          1.31798247e-01,  4.14051119e-02,  1.11731626e-02,
          0.00000000e+00, -8.89583848e-02,  1.20076058e-04,
          0.00000000e+00, -8.43705836e-04],
        [ 7.87048705e-01,  1.14069591e-01, -3.62195685e-01,
         -1.71482299e-01, -4.98735345e-03,  3.22860569e-03,
         -4.01709394e-04, -6.16365153e-02, -6.93247574e-02,
          1.21947194e-01, -1.51619560e-04, -9.01948826e-02,
          1.56416197e-03,  1.96041569e-01, -2.04955771e-02,
         -3.31660885e-02, -8.94283673e-03, -2.93783168e-03,
          0.00000000e+00, -3.67777353e-01,  2.58146832e-04,
          0.00000000e+00,  4.66038804e-04],
        [ 2.28051493e-03,  6.91273124e-04,  7.07057922e-01,
         -1.01439208e-03, -2.44886069e-05,  1.99130400e-04,
         -4.51319737e-05,  1.42842702e-02,  7.38886061e-03,
          6.51141842e-03, -6.17706950e-06, -2.89885212e-04,
          8.88984740e-05, -2.69369204e-02, -1.19727187e-03,
         -1.86999343e-03, -5.89880091e-04, -1.79887167e-04,
          5.20417043e-18, -7.06420773e-01,  2.73459895e-05,
          0.00000000e+00,  3.80317664e-05],
        [ 1.30702273e-01,  4.16978017e-02, -8.91235662e-02,
         -6.13090187e-02, -1.33381519e-03,  6.87072180e-03,
         -1.59359360e-03,  5.07740516e-01,  2.21976985e-01,
          2.21973929e-01, -2.07405990e-04, -2.39584007e-02,
          3.05321800e-03, -7.77356097e-01, -4.10396061e-02,
         -6.43221718e-02, -2.01057558e-02, -6.20431547e-03,
          5.55111512e-17, -4.41061120e-02,  9.63515224e-04,
          0.00000000e+00,  1.32834008e-03],
        [-2.37071773e-01, -8.86891483e-02, -3.08771296e-01,
          1.29497547e-01,  2.20628230e-03, -8.67943385e-03,
          2.37308481e-03,  7.11653463e-01, -1.87390215e-01,
         -2.57726712e-01,  2.05099427e-04,  5.89179260e-02,
         -3.71410692e-03,  3.24311614e-01,  4.97920470e-02,
          7.83897657e-02,  2.42119590e-02,  7.81293050e-03,
          0.00000000e+00, -3.12741481e-01, -1.41365588e-03,
          0.00000000e+00, -1.83555043e-03],
        [-1.52905997e-02, -1.23071410e-02, -1.43439358e-02,
          1.64717834e-02, -9.51433687e-04,  5.85421891e-01,
         -5.22068979e-01, -4.13443733e-03,  2.61529015e-02,
          5.74820600e-03,  4.74556551e-02,  9.93604657e-03,
          6.77143011e-02,  1.64295269e-02, -1.12808282e-02,
         -2.74666493e-03, -1.44689643e-02, -4.94481358e-01,
          0.00000000e+00, -1.44351074e-02,  2.63265400e-01,
          0.00000000e+00,  2.48090528e-01],
        [ 2.00695093e-01,  2.91466972e-01,  2.87180479e-01,
         -3.63078784e-01,  4.34514775e-02,  2.28593792e-02,
         -2.88333379e-02,  1.88246122e-01, -4.24713135e-01,
         -4.45391431e-01,  3.47728873e-03, -2.82526103e-01,
         -2.98911556e-03, -1.13776766e-01,  1.39500146e-01,
          1.98432101e-01,  8.93288614e-02, -1.81997957e-02,
          0.00000000e+00,  2.87782945e-01,  1.27213549e-02,
          0.00000000e+00,  1.10378059e-02],
        [ 2.67355662e-01, -4.03091203e-01,  1.38574486e-03,
          3.19851736e-01, -1.84099352e-01,  3.80026942e-03,
         -8.70800118e-03, -1.34691861e-01, -3.69548565e-01,
         -2.23195140e-01,  1.70086239e-03,  5.16201870e-01,
         -4.54139776e-03, -3.00731043e-01,  1.47501547e-01,
          1.79123088e-01,  1.20168864e-01, -1.90892495e-03,
          0.00000000e+00,  3.18915913e-03,  1.05603468e-03,
          0.00000000e+00,  3.25080258e-04],
        [-2.13953115e-01,  4.10097210e-01, -2.50779597e-01,
          2.19096359e-01,  4.42865286e-01,  1.21361156e-02,
         -1.75269179e-02, -2.46561507e-01, -1.14035532e-01,
          9.46570807e-02,  1.25454062e-02, -3.87611918e-02,
         -1.88890206e-02, -2.04937318e-01,  3.11105818e-01,
          3.17444893e-01,  3.01542324e-01,  5.98037592e-03,
          0.00000000e+00, -2.50720746e-01, -1.39706382e-02,
          0.00000000e+00, -1.47079819e-02],
        [ 1.09902642e-01,  3.04233036e-01,  5.25321979e-02,
          3.13539902e-01,  3.83729129e-01, -2.35507433e-01,
          9.61943777e-02,  2.10092754e-02, -9.97472687e-02,
         -2.15389710e-01, -2.83772670e-01,  2.09850059e-01,
          1.62808110e-01, -3.32171483e-02, -3.04008474e-01,
         -2.97926254e-01, -3.03845431e-01, -2.06293518e-01,
          4.23516474e-22,  5.29210854e-02,  1.64799812e-01,
          0.00000000e+00,  1.65391227e-01],
        [ 7.86967503e-02,  1.72107925e-01,  4.62662964e-02,
          1.85056706e-01,  2.19747367e-01,  4.01787503e-01,
         -1.21708705e-01,  2.76205858e-02, -4.81725917e-02,
         -1.24586624e-01,  4.90026906e-01,  1.31822329e-01,
         -2.36446569e-01, -5.70435499e-03, -1.92176972e-01,
         -1.92852034e-01, -1.89928235e-01,  3.65843309e-01,
          4.23516474e-22,  4.64923431e-02, -2.50268914e-01,
          0.00000000e+00, -2.49763201e-01],
        [-1.48612089e-01, -5.85142438e-02, -1.53603086e-01,
         -1.08809944e-01, -8.96443849e-02,  2.04572687e-01,
          3.73352537e-01, -1.53692883e-01, -1.41761537e-01,
         -1.23608317e-01,  2.99206276e-01, -1.30288266e-01,
          3.83251555e-01, -1.50080534e-01, -9.10637927e-02,
         -8.18949588e-02, -9.58247486e-02,  3.11017153e-01,
          0.00000000e+00, -1.53587496e-01,  3.66433378e-01,
          0.00000000e+00,  3.68918163e-01],
        [-2.68747745e-01, -1.00131938e-01, -2.80575388e-01,
         -1.90814734e-01, -1.54818075e-01, -9.92561433e-02,
         -1.94988884e-01, -2.82641870e-01, -2.70847893e-01,
         -2.50818380e-01, -1.46514769e-01, -2.32190851e-01,
         -2.04088197e-01, -2.80031330e-01, -2.15471294e-01,
         -2.06142479e-01, -2.20590883e-01, -1.54468446e-01,
         -8.78843834e-10, -2.80525323e-01, -1.98337145e-01,
          0.00000000e+00, -1.99236686e-01],
        [ 2.36187298e-10,  8.80003360e-11,  2.46581927e-10,
          1.67696352e-10,  1.36060911e-10,  8.72306466e-11,
          1.71364793e-10,  2.48398124e-10,  2.38033022e-10,
          2.20430187e-10,  1.28763601e-10,  2.04059498e-10,
          1.79361579e-10,  2.46103751e-10,  1.89365580e-10,
          1.81167053e-10,  1.93864968e-10,  1.35753644e-10,
         -1.00000000e+00,  2.46537947e-10,  1.74307318e-10,
          0.00000000e+00,  1.75098054e-10],
        [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         -1.00000000e+00,  0.00000000e+00]]))</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-execution_count="616">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="op">%</span>run heavysnow.py</span>
<span id="cb47-2"><a href="#cb47-2"></a>spa<span class="op">=</span>SpectralAnalysis(gs)</span>
<span id="cb47-3"><a href="#cb47-3"></a>spa.graphFouriertransform()</span>
<span id="cb47-4"><a href="#cb47-4"></a>spa.decompose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-42" class="cell" data-execution_count="617">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>plt.imshow(spa.Lz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-43" class="cell" data-execution_count="618">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>spa.Lz[<span class="dv">13</span>:<span class="dv">18</span>,<span class="dv">13</span>:<span class="dv">18</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="618">
<pre><code>array([[ 1.00000000e+00, -3.47748512e-02, -2.56935107e-02,
        -4.14298210e-02, -6.56720534e-12],
       [-3.47748512e-02,  1.00000000e+00, -3.13567731e-01,
        -2.95687253e-01, -1.13797574e-06],
       [-2.56935107e-02, -3.13567731e-01,  1.00000000e+00,
        -2.99256990e-01, -2.77663248e-06],
       [-4.14298210e-02, -2.95687253e-01, -2.99256990e-01,
         1.00000000e+00, -6.51246540e-07],
       [-6.56720534e-12, -1.13797574e-06, -2.77663248e-06,
        -6.51246540e-07,  1.00000000e+00]])</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-execution_count="619">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a><span class="op">%%</span>R </span>
<span id="cb51-2"><a href="#cb51-2"></a>    D<span class="op">&lt;-</span>degree(WW)</span>
<span id="cb51-3"><a href="#cb51-3"></a>    D_rootinv<span class="op">&lt;-</span>degree_rootinv(WW)</span>
<span id="cb51-4"><a href="#cb51-4"></a>    L<span class="op">&lt;-</span>D<span class="op">-</span>WW</span>
<span id="cb51-5"><a href="#cb51-5"></a>    L_tilde<span class="op">&lt;-</span>D_rootinv<span class="op">%*%</span>L<span class="op">%*%</span>D_rootinv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-execution_count="620">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a><span class="op">%</span>R <span class="op">-</span>o L_tilde</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-46" class="cell" data-execution_count="621">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>plt.imshow(spa.Lz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="622">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>plt.imshow(L_tilde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-48" class="cell" data-execution_count="623">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>spa.Psi[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="623">
<pre><code>array([ 8.31802845e-07, -2.28244345e-02,  1.69005964e-05,  8.32458517e-05,
        1.37445367e-03, -1.69822716e-03, -2.72169523e-04,  1.62367170e-01,
        1.00120612e-01,  7.87048705e-01,  2.28051493e-03,  1.30702273e-01,
       -2.37071773e-01, -1.52905997e-02,  2.00695093e-01,  2.67355662e-01,
       -2.13953115e-01,  1.09902642e-01,  7.86967503e-02, -1.48612089e-01,
       -2.68747745e-01,  1.30686848e-15,  0.00000000e+00])</code></pre>
</div>
</div>
<div id="cell-49" class="cell" data-execution_count="624">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>Psi[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="624">
<pre><code>array([ 8.31802846e-07, -2.28244345e-02,  1.69005964e-05,  8.32458517e-05,
        1.37445367e-03, -1.69822716e-03, -2.72169523e-04,  1.62367170e-01,
        1.00120612e-01,  7.87048705e-01,  2.28051493e-03, -1.30702273e-01,
       -2.37071773e-01, -1.52905997e-02,  2.00695093e-01,  2.67355662e-01,
       -2.13953115e-01,  1.09902642e-01,  7.86967503e-02, -1.48612089e-01,
       -2.68747745e-01,  4.53298893e-07,  1.40733495e-38])</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="625">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>spa.fbar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="625">
<pre><code>array([-2.10281887e+02,  1.40244756e+01,  8.71311468e+00,  7.45361934e+01,
       -3.80931713e+01,  6.17719604e+01, -2.14128291e+02, -3.55025393e+00,
        1.92122028e+01, -3.86380121e+00,  4.42134781e-01, -8.70162667e+00,
        1.07088816e+01,  3.00488134e+02,  3.01659077e+01,  4.85119271e+01,
        3.80885030e+02, -7.85570930e+02,  5.73774201e+02,  1.80256280e+03,
       -3.59847855e+03, -2.04835975e+03, -2.79627440e+03])</code></pre>
</div>
</div>
<div id="cell-51" class="cell" data-execution_count="626">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>plt.imshow(spa.Psi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="627">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>U, lamb, Vt <span class="op">=</span>np.linalg.svd(spa.Lz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-53" class="cell" data-execution_count="628">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>plt.imshow(Vt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="629">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>plt.imshow(U <span class="op">@</span> np.diag(lamb) <span class="op">@</span> Vt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="630">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>plt.imshow(spa.Lz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="631">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>fbar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="631">
<pre><code>array([-2.10281887e+02,  1.40244756e+01,  8.71311468e+00,  7.45361934e+01,
       -3.80931713e+01,  6.17719604e+01, -2.14128291e+02, -3.55025393e+00,
        1.92122028e+01, -3.86380121e+00,  4.42134781e-01,  8.70162667e+00,
        1.07088816e+01,  3.00488134e+02,  3.01659077e+01,  4.85119271e+01,
        3.80885030e+02, -7.85570930e+02,  5.73774201e+02,  1.80256280e+03,
       -3.59847510e+03,  2.04836582e+03, -2.79627440e+03])</code></pre>
</div>
</div>
<div id="cell-57" class="cell" data-execution_count="632">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>plt.imshow(Psi <span class="op">@</span>np.diag(lamb) <span class="op">@</span> Psi.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-58" class="cell" data-execution_count="633">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>Psi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="633">
<pre><code>array([[ 8.31802846e-07, -2.28244345e-02,  1.69005964e-05,
         8.32458517e-05,  1.37445367e-03, -1.69822716e-03,
        -2.72169523e-04,  1.62367170e-01,  1.00120612e-01,
         7.87048705e-01,  2.28051493e-03, -1.30702273e-01,
        -2.37071773e-01, -1.52905997e-02,  2.00695093e-01,
         2.67355662e-01, -2.13953115e-01,  1.09902642e-01,
         7.86967503e-02, -1.48612089e-01, -2.68747745e-01,
         4.53298893e-07,  1.40733495e-38],
       [-1.73745234e-07,  5.82817056e-01,  3.19679606e-06,
         1.95527208e-05, -4.01026817e-04,  1.79423330e-03,
         1.42218015e-03, -2.93595666e-01, -1.03797754e-02,
         1.14069591e-01,  6.91273124e-04, -4.16978017e-02,
        -8.86891483e-02, -1.23071410e-02,  2.91466972e-01,
        -4.03091203e-01,  4.10097210e-01,  3.04233036e-01,
         1.72107925e-01, -5.85142438e-02, -1.00131938e-01,
         1.68893309e-07,  5.24354816e-39],
       [ 1.79945470e-06, -8.86372067e-03, -1.04110175e-05,
        -9.71301027e-06,  4.57105960e-03, -4.80419733e-03,
        -1.70253832e-03,  6.84489722e-02, -8.94572257e-02,
        -3.62195685e-01,  7.07057922e-01,  8.91235662e-02,
        -3.08771296e-01, -1.43439358e-02,  2.87180479e-01,
         1.38574486e-03, -2.50779597e-01,  5.25321979e-02,
         4.62662964e-02, -1.53603086e-01, -2.80575388e-01,
         4.73248670e-07,  1.46927205e-38],
       [-3.81405816e-07,  3.49123335e-01, -1.13849656e-05,
        -5.20669020e-05,  1.71456172e-03, -4.55458198e-03,
        -3.23802030e-03,  6.03887632e-01,  1.59324493e-02,
        -1.71482299e-01, -1.01439208e-03,  6.13090187e-02,
         1.29497547e-01,  1.64717834e-02, -3.63078784e-01,
         3.19851736e-01,  2.19096359e-01,  3.13539902e-01,
         1.85056706e-01, -1.08809944e-01, -1.90814734e-01,
         3.21848681e-07,  9.99227897e-39],
       [ 3.16749178e-07, -7.33268982e-01, -5.84182485e-07,
        -5.10615468e-06,  1.76538169e-05, -3.21602859e-04,
        -2.73625670e-04,  5.32095578e-02,  8.79091764e-04,
        -4.98735345e-03, -2.44886069e-05,  1.33381519e-03,
         2.20628230e-03, -9.51433687e-04,  4.34514775e-02,
        -1.84099352e-01,  4.42865286e-01,  3.83729129e-01,
         2.19747367e-01, -8.96443849e-02, -1.54818075e-01,
         2.61132838e-07,  8.10726382e-39],
       [-4.21211716e-01, -1.26228933e-06,  9.91140473e-03,
         1.05442602e-01, -2.34738842e-02,  8.53928708e-02,
        -4.37304704e-01, -1.81877637e-03, -1.21592942e-02,
         3.22860569e-03,  1.99130400e-04, -6.87072180e-03,
        -8.67943385e-03,  5.85421891e-01,  2.28593792e-02,
         3.80026942e-03,  1.21361156e-02, -2.35507433e-01,
         4.01787503e-01,  2.04572687e-01, -9.92561433e-02,
         1.67416356e-07,  5.19769120e-39],
       [ 7.57297687e-02, -6.30483358e-06,  3.91285206e-02,
         3.71727089e-01, -4.54039898e-02,  1.26342172e-01,
        -6.01054964e-01, -1.99193673e-03, -3.77249821e-04,
        -4.01709394e-04, -4.51319737e-05,  1.59359360e-03,
         2.37308481e-03, -5.22068979e-01, -2.88333379e-02,
        -8.70800118e-03, -1.75269179e-02,  9.61943777e-02,
        -1.21708705e-01,  3.73352537e-01, -1.94988884e-01,
         3.28889581e-07,  1.02108736e-38],
       [ 1.86543546e-06, -2.97029443e-03, -3.36972961e-05,
        -1.05359128e-04,  4.99362785e-03, -5.24357048e-03,
        -2.35731474e-03,  2.37200800e-02, -1.09617362e-01,
        -6.16365153e-02,  1.42842702e-02, -5.07740516e-01,
         7.11653463e-01, -4.13443733e-03,  1.88246122e-01,
        -1.34691861e-01, -2.46561507e-01,  2.10092754e-02,
         2.76205858e-02, -1.53692883e-01, -2.82641870e-01,
         4.76734222e-07,  1.48009348e-38],
       [-7.99573985e-06,  3.95206738e-03, -6.27063562e-05,
        -3.92509820e-04, -1.69919218e-02,  1.62054211e-02,
         2.80023428e-03, -4.07149823e-02,  6.87137136e-01,
        -6.93247574e-02,  7.38886061e-03, -2.21976985e-01,
        -1.87390215e-01,  2.61529015e-02, -4.24713135e-01,
        -3.69548565e-01, -1.14035532e-01, -9.97472687e-02,
        -4.81725917e-02, -1.41761537e-01, -2.70847893e-01,
         4.56841235e-07,  1.41833269e-38],
       [-3.95062745e-05,  1.57431046e-03,  4.06604890e-04,
         1.18991491e-03, -7.33907458e-02,  7.64563613e-02,
         3.33175204e-02, -5.19933079e-03, -6.78035427e-01,
         1.21947194e-01,  6.51141842e-03, -2.21973929e-01,
        -2.57726712e-01,  5.74820600e-03, -4.45391431e-01,
        -2.23195140e-01,  9.46570807e-02, -2.15389710e-01,
        -1.24586624e-01, -1.23608317e-01, -2.50818380e-01,
         4.23057305e-07,  1.31344537e-38],
       [ 7.42676668e-01,  1.32904593e-06, -3.99249712e-03,
        -3.94942827e-02,  7.34555531e-03, -2.26382886e-02,
         1.10541819e-01,  3.97233327e-04,  8.59303569e-04,
        -1.51619560e-04, -6.17706950e-06,  2.07405990e-04,
         2.05099427e-04,  4.74556551e-02,  3.47728873e-03,
         1.70086239e-03,  1.25454062e-02, -2.83772670e-01,
         4.90026906e-01,  2.99206276e-01, -1.46514769e-01,
         2.47127902e-07,  7.67245728e-39],
       [-3.90910918e-07, -6.36400071e-03,  2.21728059e-05,
         7.82229365e-05, -4.58350808e-03,  7.96250033e-03,
         4.65490914e-03, -7.12305097e-01, -1.02963001e-02,
        -9.01948826e-02, -2.89885212e-04,  2.39584007e-02,
         5.89179260e-02,  9.93604657e-03, -2.82526103e-01,
         5.16201870e-01, -3.87611918e-02,  2.09850059e-01,
         1.31822329e-01, -1.30288266e-01, -2.32190851e-01,
         3.91638098e-07,  1.21589969e-38],
       [ 4.19197158e-03, -3.33385384e-06, -3.37382216e-02,
        -8.28576687e-01,  5.81916530e-03,  3.00909739e-02,
        -1.88089877e-01, -1.03679492e-03, -6.50140854e-03,
         1.56416197e-03,  8.88984740e-05, -3.05321800e-03,
        -3.71410692e-03,  6.77143011e-02, -2.98911556e-03,
        -4.54139776e-03, -1.88890206e-02,  1.62808110e-01,
        -2.36446569e-01,  3.83251555e-01, -2.04088197e-01,
         3.44237465e-07,  1.06873721e-38],
       [-5.66982257e-08,  2.55064959e-03, -7.19961507e-05,
        -3.00326201e-04,  6.07234653e-04, -1.09077308e-03,
        -2.15658870e-03, -2.46346567e-02, -5.50520388e-02,
         1.96041569e-01, -2.69369204e-02,  7.77356097e-01,
         3.24311614e-01,  1.64295269e-02, -1.13776766e-01,
        -3.00731043e-01, -2.04937318e-01, -3.32171483e-02,
        -5.70435499e-03, -1.50080534e-01, -2.80031330e-01,
         4.72331005e-07,  1.46642303e-38],
       [ 4.10395438e-05, -3.13366217e-04,  8.14273566e-04,
         5.56447636e-03,  6.41222150e-01,  5.01569971e-01,
         5.62343554e-02,  4.95667053e-03,  8.51669174e-02,
        -2.04955771e-02, -1.19727187e-03,  4.10396061e-02,
         4.97920470e-02, -1.12808282e-02,  1.39500146e-01,
         1.47501547e-01,  3.11105818e-01, -3.04008474e-01,
        -1.92176972e-01, -9.10637927e-02, -2.15471294e-01,
         3.63437110e-07,  1.12834546e-38],
       [ 1.48848758e-04, -2.35982660e-04, -3.53800726e-03,
        -1.71372928e-02, -7.45851291e-01,  2.44486580e-01,
         8.56940821e-02,  1.15410572e-02,  1.31798247e-01,
        -3.31660885e-02, -1.86999343e-03,  6.43221718e-02,
         7.83897657e-02, -2.74666493e-03,  1.98432101e-01,
         1.79123088e-01,  3.17444893e-01, -2.97926254e-01,
        -1.92852034e-01, -8.18949588e-02, -2.06142479e-01,
         3.47702130e-07,  1.07949384e-38],
       [ 8.78543271e-07, -3.17838052e-04,  1.34421400e-03,
         6.78594911e-03,  1.51549473e-01, -8.02101418e-01,
        -1.75991858e-01, -8.06160106e-03,  4.14051119e-02,
        -8.94283673e-03, -5.89880091e-04,  2.01057558e-02,
         2.42119590e-02, -1.44689643e-02,  8.93288614e-02,
         1.20168864e-01,  3.01542324e-01, -3.03845431e-01,
        -1.89928235e-01, -9.58247486e-02, -2.20590883e-01,
         3.72072360e-07,  1.15515490e-38],
       [-5.14913484e-01,  4.18430718e-07, -9.80986052e-03,
        -1.03562437e-01,  2.24827063e-02, -8.16855839e-02,
         4.18037887e-01,  1.73339634e-03,  1.11731626e-02,
        -2.93783168e-03, -1.79887167e-04,  6.20431547e-03,
         7.81293050e-03, -4.94481358e-01, -1.81997957e-02,
        -1.90892495e-03,  5.98037592e-03, -2.06293518e-01,
         3.65843309e-01,  3.11017153e-01, -1.54468446e-01,
         2.60543425e-07,  8.08896293e-39],
       [ 1.24737016e-14,  3.93407465e-20, -3.45930152e-16,
        -3.77912922e-15,  8.60963323e-16, -3.15374791e-15,
         1.62369084e-14,  6.86568858e-17,  4.88028646e-16,
        -1.30919084e-16, -7.70880621e-17,  2.77661485e-16,
         3.55900371e-16, -2.51906933e-14, -1.02117568e-15,
        -2.06045401e-16, -1.38074571e-15,  4.25733421e-14,
        -7.66199636e-14, -7.14108351e-13,  1.68670810e-06,
         1.00000000e+00,  5.55916566e-39],
       [ 1.79531969e-06, -8.94842690e-03, -1.01546268e-05,
        -8.73262658e-06,  4.55614976e-03, -4.79156777e-03,
        -1.69335914e-03,  6.90829904e-02, -8.89583848e-02,
        -3.67777353e-01, -7.06420773e-01,  4.41061120e-02,
        -3.12741481e-01, -1.44351074e-02,  2.87782945e-01,
         3.18915913e-03, -2.50720746e-01,  5.29210854e-02,
         4.64923431e-02, -1.53587496e-01, -2.80525323e-01,
         4.73164226e-07,  1.46900989e-38],
       [-8.33021631e-03,  1.05962533e-05,  7.09113594e-01,
         2.40362541e-01,  1.65950319e-02, -6.45471772e-02,
         3.19056399e-01,  1.13629083e-03,  1.20076058e-04,
         2.58146832e-04,  2.73459895e-05, -9.63515224e-04,
        -1.41365588e-03,  2.63265400e-01,  1.27213549e-02,
         1.05603468e-03, -1.39706382e-02,  1.64799812e-01,
        -2.50268914e-01,  3.66433378e-01, -1.98337145e-01,
         3.34537107e-07,  1.03862099e-38],
       [-2.91684989e-48, -9.67870296e-54,  7.66429393e-50,
         1.08195293e-48, -2.53869829e-49,  8.96655349e-49,
        -4.58225740e-48, -2.04520610e-50, -1.56019945e-49,
         4.54073575e-50, -5.67284365e-47, -1.13905076e-48,
        -7.09980313e-50,  8.55192528e-48,  3.59904771e-49,
         8.81265710e-50,  1.23887175e-48, -6.06897321e-47,
         1.15220264e-46,  1.96550022e-44, -5.23663927e-38,
         5.55925399e-39, -1.00000000e+00],
       [-7.36022066e-03,  8.23867965e-06, -7.03038426e-01,
         3.06153537e-01,  1.79901928e-02, -5.91845158e-02,
         2.84078264e-01,  9.35442758e-04, -8.43705836e-04,
         4.66038804e-04,  3.80317664e-05, -1.32834008e-03,
        -1.83555043e-03,  2.48090528e-01,  1.10378059e-02,
         3.25080258e-04, -1.47079819e-02,  1.65391227e-01,
        -2.49763201e-01,  3.68918163e-01, -1.99236686e-01,
         3.36054372e-07,  1.04333156e-38]])</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="634">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>plt.imshow(Psi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-54-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="635">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>plt.imshow(spa.Psi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-10-29-HST example 3 파이썬으로 변경_files/figure-html/cell-55-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-61" class="cell" data-execution_count="815">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">150</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">660</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>source(<span class="st">'heavysnow.R'</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a>dat_<span class="op">&lt;-</span>tibble(V)</span>
<span id="cb73-4"><a href="#cb73-4"></a>dat_$f<span class="op">&lt;-</span><span class="im">as</span>.vector(f)</span>
<span id="cb73-5"><a href="#cb73-5"></a>dat_$divlink<span class="op">&lt;-</span><span class="dv">0</span></span>
<span id="cb73-6"><a href="#cb73-6"></a>dat_$conlink<span class="op">&lt;-</span><span class="dv">0</span></span>
<span id="cb73-7"><a href="#cb73-7"></a>dat_$link<span class="op">&lt;-</span><span class="dv">0</span></span>
<span id="cb73-8"><a href="#cb73-8"></a>dat<span class="op">&lt;-</span>dat_</span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="cf">for</span>(i <span class="kw">in</span> <span class="dv">1</span>:<span class="dv">23</span>){</span>
<span id="cb73-10"><a href="#cb73-10"></a>    dat$divlink[i]<span class="op">&lt;-</span><span class="bu">sum</span>(W[i,])</span>
<span id="cb73-11"><a href="#cb73-11"></a>    dat$conlink[i]<span class="op">&lt;-</span><span class="bu">sum</span>(W[,i])</span>
<span id="cb73-12"><a href="#cb73-12"></a>    dat$link[i]<span class="op">&lt;-</span><span class="bu">sum</span>(W[i,])<span class="op">+</span><span class="bu">sum</span>(W[i,])</span>
<span id="cb73-13"><a href="#cb73-13"></a>}</span>
<span id="cb73-14"><a href="#cb73-14"></a>p1_<span class="op">&lt;-</span>ggplot(dat)<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink),size<span class="op">=</span><span class="dv">3</span>)<span class="op">+</span>theme_light()<span class="op">+</span></span>
<span id="cb73-15"><a href="#cb73-15"></a>        geom_text_repel(aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink,label<span class="op">=</span>V),col<span class="op">=</span><span class="st">"gray40"</span>)<span class="op">+</span></span>
<span id="cb73-16"><a href="#cb73-16"></a>        ylab(<span class="st">"Out-degree"</span>)<span class="op">+</span>xlab(<span class="st">"Box office record"</span>)<span class="op">+</span></span>
<span id="cb73-17"><a href="#cb73-17"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="dv">2</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb73-18"><a href="#cb73-18"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb73-19"><a href="#cb73-19"></a>        ggtitle(<span class="st">"(a)"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">2</span>)))<span class="op">+</span></span>
<span id="cb73-20"><a href="#cb73-20"></a>        theme(axis.title.x<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))<span class="op">+</span></span>
<span id="cb73-21"><a href="#cb73-21"></a>        theme(axis.title.y<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb73-22"><a href="#cb73-22"></a>p2_<span class="op">&lt;-</span>ggplot(dat)<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink),size<span class="op">=</span><span class="dv">3</span>)<span class="op">+</span>theme_light()<span class="op">+</span></span>
<span id="cb73-23"><a href="#cb73-23"></a>        geom_text_repel(aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink,label<span class="op">=</span>V),col<span class="op">=</span><span class="st">"gray40"</span>)<span class="op">+</span></span>
<span id="cb73-24"><a href="#cb73-24"></a>        ylab(<span class="st">"In-degree"</span>)<span class="op">+</span>xlab(<span class="st">"Box office record"</span>)<span class="op">+</span></span>
<span id="cb73-25"><a href="#cb73-25"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="fl">3.75</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb73-26"><a href="#cb73-26"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="dv">2</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb73-27"><a href="#cb73-27"></a>        ggtitle(<span class="st">"(b)"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">2</span>)))<span class="op">+</span></span>
<span id="cb73-28"><a href="#cb73-28"></a>        theme(axis.title.x<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))<span class="op">+</span></span>
<span id="cb73-29"><a href="#cb73-29"></a>        theme(axis.title.y<span class="op">=</span>element_text(face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb73-30"><a href="#cb73-30"></a><span class="co"># p3_&lt;-ggplot(dat)+geom_point(aes(x=f,y=link),size=3)+theme_light()+</span></span>
<span id="cb73-31"><a href="#cb73-31"></a><span class="co">#         geom_text_repel(aes(x=f,y=link,label=V),col="gray40")+</span></span>
<span id="cb73-32"><a href="#cb73-32"></a><span class="co">#         ylab("Graph")+xlab("Box office record")+</span></span>
<span id="cb73-33"><a href="#cb73-33"></a><span class="co">#         geom_hline(aes(yintercept=6.25),col=2,lty=2,lwd=0.5)+</span></span>
<span id="cb73-34"><a href="#cb73-34"></a><span class="co">#         geom_vline(aes(xintercept=1000),col=2,lty=2,lwd=0.5)+</span></span>
<span id="cb73-35"><a href="#cb73-35"></a><span class="co">#         ggtitle("(c)")</span></span>
<span id="cb73-36"><a href="#cb73-36"></a>p1<span class="op">&lt;-</span>grid.arrange(p1_,p2_,ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb73-37"><a href="#cb73-37"></a><span class="co">#ggsave(plot=p1,"./fig/p1.pdf",width=9,height=4.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>R[write to console]: Error in library(kohonen) : there is no package called ‘kohonen’
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Error in library(kohonen) : there is no package called ‘kohonen’</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>RInterpreterError: Failed to parse and evaluate line 'source(\'heavysnow.R\')\ndat_&lt;-tibble(V)\ndat_$f&lt;-as.vector(f)\ndat_$divlink&lt;-0\ndat_$conlink&lt;-0\ndat_$link&lt;-0\ndat&lt;-dat_\nfor(i in 1:23){\n    dat$divlink[i]&lt;-sum(W[i,])\n    dat$conlink[i]&lt;-sum(W[,i])\n    dat$link[i]&lt;-sum(W[i,])+sum(W[i,])\n}\np1_&lt;-ggplot(dat)+geom_point(aes(x=f,y=divlink),size=3)+theme_light()+\n        geom_text_repel(aes(x=f,y=divlink,label=V),col="gray40")+\n        ylab("Out-degree")+xlab("Box office record")+\n        geom_hline(aes(yintercept=2),col=2,lty=2,lwd=0.5)+\n        geom_vline(aes(xintercept=1000),col=2,lty=2,lwd=0.5)+\n        ggtitle("(a)")+theme(plot.title=element_text(face="bold.italic",size=rel(2)))+\n        theme(axis.title.x=element_text(face=4,size=rel(1)))+\n        theme(axis.title.y=element_text(face=4,size=rel(1)))\np2_&lt;-ggplot(dat)+geom_point(aes(x=f,y=conlink),size=3)+theme_light()+\n        geom_text_repel(aes(x=f,y=conlink,label=V),col="gray40")+\n        ylab("In-degree")+xlab("Box office record")+\n        geom_hline(aes(yintercept=3.75),col=2,lty=2,lwd=0.5)+\n        geom_vline(aes(xintercept=1000),col=2,lty=2,lwd=0.5)+\n        ggtitle("(b)")+theme(plot.title=element_text(face="bold.italic",size=rel(2)))+\n        theme(axis.title.x=element_text(face=4,size=rel(1)))+\n        theme(axis.title.y=element_text(face=4,size=rel(1)))\n# p3_&lt;-ggplot(dat)+geom_point(aes(x=f,y=link),size=3)+theme_light()+\n#         geom_text_repel(aes(x=f,y=link,label=V),col="gray40")+\n#         ylab("Graph")+xlab("Box office record")+\n#         geom_hline(aes(yintercept=6.25),col=2,lty=2,lwd=0.5)+\n#         geom_vline(aes(xintercept=1000),col=2,lty=2,lwd=0.5)+\n#         ggtitle("(c)")\np1&lt;-grid.arrange(p1_,p2_,ncol=2)\n#ggsave(plot=p1,"./fig/p1.pdf",width=9,height=4.5)\n'.
R error message: 'Error in library(kohonen) : there is no package called ‘kohonen’'</code></pre>
</div>
</div>
</section>
<section id="gfft-수행하고-결과를-저장함." class="level3">
<h3 class="anchored" data-anchor-id="gfft-수행하고-결과를-저장함.">gfft 수행하고 결과를 저장함.</h3>
<div id="cell-63" class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a><span class="op">%%</span>R </span>
<span id="cb77-2"><a href="#cb77-2"></a>g1<span class="op">&lt;-</span>gfft(f,WEuclid)</span>
<span id="cb77-3"><a href="#cb77-3"></a>g2<span class="op">&lt;-</span>gfft(f,Wgraph)</span>
<span id="cb77-4"><a href="#cb77-4"></a>g3<span class="op">&lt;-</span>gfft(f,Whst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="아이겐플랏" class="level3">
<h3 class="anchored" data-anchor-id="아이겐플랏">아이겐플랏</h3>
<div id="cell-65" class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">150</span> <span class="op">-</span>w <span class="dv">1000</span> <span class="op">-</span>h <span class="dv">400</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>library(gridExtra)</span>
<span id="cb78-3"><a href="#cb78-3"></a>e1<span class="op">&lt;-</span>eigenplot(g1)<span class="op">+</span>ggtitle(<span class="st">"(a) Euclid weights"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb78-4"><a href="#cb78-4"></a>e2<span class="op">&lt;-</span>eigenplot(g2)<span class="op">+</span>ggtitle(<span class="st">"(b) Graph weights"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb78-5"><a href="#cb78-5"></a>e3<span class="op">&lt;-</span>eigenplot(g3)<span class="op">+</span>ggtitle(<span class="st">"(c) HST weights"</span>)<span class="op">+</span>theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="dv">1</span>)))</span>
<span id="cb78-6"><a href="#cb78-6"></a>s1<span class="op">&lt;-</span>specplot(g1)</span>
<span id="cb78-7"><a href="#cb78-7"></a>s2<span class="op">&lt;-</span>specplot(g2)</span>
<span id="cb78-8"><a href="#cb78-8"></a>s3<span class="op">&lt;-</span>specplot(g3)</span>
<span id="cb78-9"><a href="#cb78-9"></a>p2<span class="op">&lt;-</span>grid.arrange(e1,e2,e3,s1,s2,s3,nrow<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="co">#ggsave(plot=p2,"./fig/p2.pdf",width=6,height=3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="분해" class="level3">
<h3 class="anchored" data-anchor-id="분해">분해</h3>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2500</span> <span class="op">-</span>h <span class="dv">1500</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>d1<span class="op">&lt;-</span>decompose(f,WEuclid,V<span class="op">=</span>V) <span class="co"># 0, 35000, 60000, 80000</span></span>
<span id="cb79-3"><a href="#cb79-3"></a>d2<span class="op">&lt;-</span>decompose(f,Wgraph,V<span class="op">=</span>V) <span class="co"># 0, 35000, 60000, 80000</span></span>
<span id="cb79-4"><a href="#cb79-4"></a>d3<span class="op">&lt;-</span>decompose(f,Whst,V<span class="op">=</span>V) <span class="co"># 0, 35000, 60000, 80000</span></span>
<span id="cb79-5"><a href="#cb79-5"></a></span>
<span id="cb79-6"><a href="#cb79-6"></a>d1$case<span class="op">&lt;-</span><span class="st">"Euclid"</span></span>
<span id="cb79-7"><a href="#cb79-7"></a>d2$case<span class="op">&lt;-</span><span class="st">"Graph"</span></span>
<span id="cb79-8"><a href="#cb79-8"></a>d3$case<span class="op">&lt;-</span><span class="st">"HST"</span></span>
<span id="cb79-9"><a href="#cb79-9"></a>decomprslt<span class="op">&lt;-</span>rbind(d1,d2,d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-68" class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">150</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">4200</span></span>
<span id="cb80-2"><a href="#cb80-2"></a></span>
<span id="cb80-3"><a href="#cb80-3"></a>decomp_dat<span class="op">&lt;-</span> decomprslt <span class="op">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4"></a>                group_by(case,eigenvectorindex) <span class="op">%&gt;%</span> </span>
<span id="cb80-5"><a href="#cb80-5"></a>                mutate(textsize<span class="op">=</span> <span class="dv">10</span><span class="op">*</span>(<span class="bu">abs</span>(fhat)<span class="op">&gt;</span><span class="dv">50</span>))</span>
<span id="cb80-6"><a href="#cb80-6"></a>        </span>
<span id="cb80-7"><a href="#cb80-7"></a>p3<span class="op">&lt;-</span>ggplot(data<span class="op">=</span><span class="bu">filter</span>(decomp_dat,eigenvectorindex <span class="op">%</span><span class="kw">in</span><span class="op">%</span> <span class="dv">1</span>:<span class="dv">23</span>))<span class="op">+</span></span>
<span id="cb80-8"><a href="#cb80-8"></a>    geom_col(aes(x<span class="op">=</span>Vindex,y<span class="op">=</span>fhat,fill<span class="op">=</span>fhat<span class="op">&gt;</span><span class="dv">0</span>),width<span class="op">=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb80-9"><a href="#cb80-9"></a>    geom_text_repel(aes(x<span class="op">=</span>Vindex,y<span class="op">=</span>fhat,label<span class="op">=</span>V,size<span class="op">=</span>textsize),col<span class="op">=</span><span class="dv">1</span>,fontface<span class="op">=</span><span class="dv">4</span>,alpha<span class="op">=</span><span class="fl">0.8</span>,segment.size<span class="op">=</span><span class="fl">0.2</span>,segment.color<span class="op">=</span><span class="st">"gray60"</span>,<span class="bu">min</span>.segment.length<span class="op">=</span><span class="dv">5</span>,hjust<span class="op">=</span><span class="fl">0.1</span>)<span class="op">+</span></span>
<span id="cb80-10"><a href="#cb80-10"></a>    scale_radius(<span class="bu">range</span> <span class="op">=</span> c(<span class="dv">0</span>,<span class="fl">1.8</span>))<span class="op">+</span></span>
<span id="cb80-11"><a href="#cb80-11"></a>    guides(size<span class="op">=</span>FALSE)<span class="op">+</span></span>
<span id="cb80-12"><a href="#cb80-12"></a>    facet_grid(eigenvectorindex<span class="op">~</span>case)<span class="op">+</span></span>
<span id="cb80-13"><a href="#cb80-13"></a>    geom_hline(aes(yintercept<span class="op">=</span><span class="dv">0</span>),col<span class="op">=</span><span class="st">"gray60"</span>,lty<span class="op">=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb80-14"><a href="#cb80-14"></a>    xlab(<span class="st">""</span>)<span class="op">+</span>ylab(<span class="st">""</span>)<span class="op">+</span>guides(fill<span class="op">=</span>FALSE)<span class="op">+</span></span>
<span id="cb80-15"><a href="#cb80-15"></a>    theme(axis.text.x<span class="op">=</span>element_text(angle<span class="op">=</span><span class="dv">85</span>,hjust<span class="op">=</span><span class="dv">1</span>,vjust<span class="op">=</span><span class="dv">1</span>,face<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>rel(<span class="fl">0.7</span>),colour<span class="op">=</span><span class="st">"gray60"</span>))<span class="op">+</span></span>
<span id="cb80-16"><a href="#cb80-16"></a>    theme_light()<span class="op">+</span></span>
<span id="cb80-17"><a href="#cb80-17"></a>    theme(strip.text.x <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb80-18"><a href="#cb80-18"></a>    theme(strip.text.y <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb80-19"><a href="#cb80-19"></a>    theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="fl">1.5</span>)))</span>
<span id="cb80-20"><a href="#cb80-20"></a>show(p3)</span>
<span id="cb80-21"><a href="#cb80-21"></a></span>
<span id="cb80-22"><a href="#cb80-22"></a><span class="co"># decomp_dat&lt;- decomprslt %&gt;% </span></span>
<span id="cb80-23"><a href="#cb80-23"></a><span class="co">#                 group_by(case,eigenvectorindex) %&gt;% </span></span>
<span id="cb80-24"><a href="#cb80-24"></a><span class="co">#                 mutate(textsize=(fhat&gt;mean(fhat)) *(fhat&gt;240) * ((case=="Euclid")*1.7+</span></span>
<span id="cb80-25"><a href="#cb80-25"></a><span class="co">#                                                                  (case!="Euclid")*(eigenvectorindex!=1)*1.7+</span></span>
<span id="cb80-26"><a href="#cb80-26"></a><span class="co">#                                                                  (case!="Euclid")*(eigenvectorindex==1)*1))</span></span>
<span id="cb80-27"><a href="#cb80-27"></a></span>
<span id="cb80-28"><a href="#cb80-28"></a></span>
<span id="cb80-29"><a href="#cb80-29"></a><span class="co"># p3&lt;-ggplot(data=filter(decomp_dat,eigenvectorindex %in% 1:7))+</span></span>
<span id="cb80-30"><a href="#cb80-30"></a><span class="co">#     geom_col(aes(x=Vindex,y=fhat,fill=fhat&gt;0),width=0.7)+</span></span>
<span id="cb80-31"><a href="#cb80-31"></a><span class="co">#     geom_text_repel(aes(x=Vindex,y=fhat,label=V,size=textsize),col=1,fontface=4,alpha=0.8,segment.size=0.2,segment.color="gray60",min.segment.length=5,hjust=0.1)+</span></span>
<span id="cb80-32"><a href="#cb80-32"></a><span class="co">#     scale_radius(range = c(0,1.8))+</span></span>
<span id="cb80-33"><a href="#cb80-33"></a><span class="co">#     guides(size=FALSE)+</span></span>
<span id="cb80-34"><a href="#cb80-34"></a><span class="co">#     facet_grid(eigenvectorindex~case)+</span></span>
<span id="cb80-35"><a href="#cb80-35"></a><span class="co">#     geom_hline(aes(yintercept=0),col="gray60",lty=2)+</span></span>
<span id="cb80-36"><a href="#cb80-36"></a><span class="co">#     xlab("")+ylab("")+guides(fill=FALSE)+</span></span>
<span id="cb80-37"><a href="#cb80-37"></a><span class="co">#     theme(axis.text.x=element_text(angle=85,hjust=1,vjust=1,face=4,size=rel(0.7),colour="gray60"))+</span></span>
<span id="cb80-38"><a href="#cb80-38"></a><span class="co">#     theme_light()+</span></span>
<span id="cb80-39"><a href="#cb80-39"></a><span class="co">#     theme(strip.text.x = element_text(size = 10, color = "black", face = "bold.italic"))+</span></span>
<span id="cb80-40"><a href="#cb80-40"></a><span class="co">#     theme(strip.text.y = element_text(size = 10, color = "black", face = "bold.italic"))+</span></span>
<span id="cb80-41"><a href="#cb80-41"></a><span class="co">#     theme(plot.title=element_text(face="bold.italic",size=rel(1.5)))</span></span>
<span id="cb80-42"><a href="#cb80-42"></a><span class="co"># show(p3)</span></span>
<span id="cb80-43"><a href="#cb80-43"></a><span class="co">#ggsave(plot=p3,"./fig/p3.pdf",width=6,height=6)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-69" class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a><span class="op">%%</span>R</span>
<span id="cb81-2"><a href="#cb81-2"></a>dat3_Euclid <span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Euclid"</span>,eigenvectorindex<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb81-3"><a href="#cb81-3"></a>dat3_Euclid <span class="op">&lt;-</span> left_join(dat,dat3_Euclid,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb81-4"><a href="#cb81-4"></a></span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="cf">for</span>(j <span class="kw">in</span> <span class="dv">2</span>:<span class="dv">23</span>){</span>
<span id="cb81-6"><a href="#cb81-6"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Euclid"</span>,eigenvectorindex<span class="op">==</span>j) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb81-7"><a href="#cb81-7"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> left_join(dat,decomp_filtered_dat_,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb81-8"><a href="#cb81-8"></a>        dat3_Euclid<span class="op">&lt;-</span>rbind(dat3_Euclid,decomp_filtered_dat_)</span>
<span id="cb81-9"><a href="#cb81-9"></a>}</span>
<span id="cb81-10"><a href="#cb81-10"></a></span>
<span id="cb81-11"><a href="#cb81-11"></a>dat3_Graph <span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Graph"</span>,eigenvectorindex<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb81-12"><a href="#cb81-12"></a>dat3_Graph <span class="op">&lt;-</span> left_join(dat,dat3_Graph,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb81-13"><a href="#cb81-13"></a></span>
<span id="cb81-14"><a href="#cb81-14"></a><span class="cf">for</span>(j <span class="kw">in</span> <span class="dv">2</span>:<span class="dv">23</span>){</span>
<span id="cb81-15"><a href="#cb81-15"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"Graph"</span>,eigenvectorindex<span class="op">==</span>j) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb81-16"><a href="#cb81-16"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> left_join(dat,decomp_filtered_dat_,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb81-17"><a href="#cb81-17"></a>        dat3_Graph<span class="op">&lt;-</span>rbind(dat3_Graph,decomp_filtered_dat_)</span>
<span id="cb81-18"><a href="#cb81-18"></a>}</span>
<span id="cb81-19"><a href="#cb81-19"></a></span>
<span id="cb81-20"><a href="#cb81-20"></a>dat3_HST <span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"HST"</span>,eigenvectorindex<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb81-21"><a href="#cb81-21"></a>dat3_HST <span class="op">&lt;-</span> left_join(dat,dat3_HST,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb81-22"><a href="#cb81-22"></a></span>
<span id="cb81-23"><a href="#cb81-23"></a><span class="cf">for</span>(j <span class="kw">in</span> <span class="dv">2</span>:<span class="dv">23</span>){</span>
<span id="cb81-24"><a href="#cb81-24"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> decomp_dat <span class="op">%&gt;%</span> <span class="bu">filter</span>(case<span class="op">==</span><span class="st">"HST"</span>,eigenvectorindex<span class="op">==</span>j) <span class="op">%&gt;%</span> select(V,case,eigenvectorindex,textsize,fhat)</span>
<span id="cb81-25"><a href="#cb81-25"></a>        decomp_filtered_dat_<span class="op">&lt;-</span> left_join(dat,decomp_filtered_dat_,by<span class="op">=</span><span class="st">"V"</span>)</span>
<span id="cb81-26"><a href="#cb81-26"></a>        dat3_HST<span class="op">&lt;-</span>rbind(dat3_HST,decomp_filtered_dat_)</span>
<span id="cb81-27"><a href="#cb81-27"></a>}</span>
<span id="cb81-28"><a href="#cb81-28"></a>dat3<span class="op">&lt;-</span>rbind(dat3_Euclid,dat3_Graph,dat3_HST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-70" class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">3000</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>hull_cyl <span class="op">&lt;-</span> dat3 <span class="op">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>            group_by(case,eigenvectorindex) <span class="op">%&gt;%</span> </span>
<span id="cb82-4"><a href="#cb82-4"></a>            <span class="bu">filter</span>(textsize<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">%&gt;%</span> </span>
<span id="cb82-5"><a href="#cb82-5"></a>            <span class="bu">slice</span>(chull(f, divlink))</span>
<span id="cb82-6"><a href="#cb82-6"></a>p4<span class="op">&lt;-</span>ggplot(dat3<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>))<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink,col<span class="op">=</span>textsize<span class="op">&gt;</span><span class="dv">0</span>,size<span class="op">=</span>fhat<span class="op">*</span>(fhat<span class="op">&gt;</span><span class="dv">0</span>)),alpha<span class="op">=</span><span class="fl">0.8</span>)<span class="op">+</span></span>
<span id="cb82-7"><a href="#cb82-7"></a>        geom_shape(data<span class="op">=</span>hull_cyl<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>) ,aes(x<span class="op">=</span>f,y<span class="op">=</span>divlink),alpha<span class="op">=</span><span class="fl">0.05</span>,col<span class="op">=</span><span class="st">"gray30"</span>,radius<span class="op">=</span><span class="fl">0.05</span>,expand<span class="op">=</span><span class="fl">0.05</span>)<span class="op">+</span></span>
<span id="cb82-8"><a href="#cb82-8"></a>        facet_grid(eigenvectorindex<span class="op">~</span>case)<span class="op">+</span></span>
<span id="cb82-9"><a href="#cb82-9"></a>        scale_size_continuous(<span class="bu">range</span><span class="op">=</span>c(<span class="dv">2</span>,<span class="fl">2.5</span>))<span class="op">+</span></span>
<span id="cb82-10"><a href="#cb82-10"></a>        scale_color_manual(values<span class="op">=</span>c(<span class="st">"gray80"</span>, <span class="st">"gray20"</span>))<span class="op">+</span></span>
<span id="cb82-11"><a href="#cb82-11"></a>        ylim(<span class="dv">0</span>,<span class="dv">8</span>)<span class="op">+</span>xlim(<span class="dv">0</span>,<span class="dv">3000</span>)<span class="op">+</span></span>
<span id="cb82-12"><a href="#cb82-12"></a>        guides(alpha<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb82-13"><a href="#cb82-13"></a>        guides(col<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb82-14"><a href="#cb82-14"></a>        guides(size<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb82-15"><a href="#cb82-15"></a>        ylab(<span class="st">""</span>)<span class="op">+</span>xlab(<span class="st">""</span>)<span class="op">+</span></span>
<span id="cb82-16"><a href="#cb82-16"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="dv">2</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb82-17"><a href="#cb82-17"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb82-18"><a href="#cb82-18"></a>        theme_light()<span class="op">+</span></span>
<span id="cb82-19"><a href="#cb82-19"></a>        theme(strip.text.x <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb82-20"><a href="#cb82-20"></a>        theme(strip.text.y <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb82-21"><a href="#cb82-21"></a>        theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="fl">1.5</span>)))</span>
<span id="cb82-22"><a href="#cb82-22"></a>show(p4)</span>
<span id="cb82-23"><a href="#cb82-23"></a><span class="co">#ggsave(plot=p4,"./fig/p4.pdf",width=7,height=7)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-71" class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">3000</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>hull_cyl <span class="op">&lt;-</span> dat3 <span class="op">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3"></a>            group_by(case,eigenvectorindex) <span class="op">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4"></a>            <span class="bu">filter</span>(textsize<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">%&gt;%</span> </span>
<span id="cb83-5"><a href="#cb83-5"></a>            <span class="bu">slice</span>(chull(f, conlink))</span>
<span id="cb83-6"><a href="#cb83-6"></a>p5<span class="op">&lt;-</span>ggplot(dat3<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>))<span class="op">+</span>geom_point(aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink,col<span class="op">=</span>textsize<span class="op">&gt;</span><span class="dv">0</span>,size<span class="op">=</span>fhat<span class="op">*</span>(fhat<span class="op">&gt;</span><span class="dv">0</span>)),alpha<span class="op">=</span><span class="fl">0.8</span>)<span class="op">+</span></span>
<span id="cb83-7"><a href="#cb83-7"></a>        geom_shape(data<span class="op">=</span>hull_cyl<span class="op">%&gt;%</span> <span class="bu">filter</span>(eigenvectorindex<span class="op">&lt;</span><span class="dv">8</span>) ,aes(x<span class="op">=</span>f,y<span class="op">=</span>conlink),alpha<span class="op">=</span><span class="fl">0.05</span>,col<span class="op">=</span><span class="st">"gray30"</span>,radius<span class="op">=</span><span class="fl">0.05</span>,expand<span class="op">=</span><span class="fl">0.05</span>)<span class="op">+</span></span>
<span id="cb83-8"><a href="#cb83-8"></a>        facet_grid(eigenvectorindex<span class="op">~</span>case)<span class="op">+</span></span>
<span id="cb83-9"><a href="#cb83-9"></a>        scale_size_continuous(<span class="bu">range</span><span class="op">=</span>c(<span class="dv">2</span>,<span class="fl">2.5</span>))<span class="op">+</span></span>
<span id="cb83-10"><a href="#cb83-10"></a>        scale_color_manual(values<span class="op">=</span>c(<span class="st">"gray80"</span>, <span class="st">"gray20"</span>))<span class="op">+</span>        </span>
<span id="cb83-11"><a href="#cb83-11"></a>        ylim(<span class="dv">0</span>,<span class="dv">10</span>)<span class="op">+</span>xlim(<span class="dv">0</span>,<span class="dv">3000</span>)<span class="op">+</span></span>
<span id="cb83-12"><a href="#cb83-12"></a>        guides(col<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb83-13"><a href="#cb83-13"></a>        guides(alpha<span class="op">=</span>F)<span class="op">+</span></span>
<span id="cb83-14"><a href="#cb83-14"></a>        guides(size<span class="op">=</span>F)<span class="op">+</span>       </span>
<span id="cb83-15"><a href="#cb83-15"></a>        ylab(<span class="st">""</span>)<span class="op">+</span>xlab(<span class="st">""</span>)<span class="op">+</span></span>
<span id="cb83-16"><a href="#cb83-16"></a>        geom_hline(aes(yintercept<span class="op">=</span><span class="fl">3.75</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb83-17"><a href="#cb83-17"></a>        geom_vline(aes(xintercept<span class="op">=</span><span class="dv">1000</span>),col<span class="op">=</span><span class="st">"gray30"</span>,lty<span class="op">=</span><span class="dv">2</span>,lwd<span class="op">=</span><span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb83-18"><a href="#cb83-18"></a>        theme_light()<span class="op">+</span></span>
<span id="cb83-19"><a href="#cb83-19"></a>        theme(strip.text.x <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb83-20"><a href="#cb83-20"></a>        theme(strip.text.y <span class="op">=</span> element_text(size <span class="op">=</span> <span class="dv">10</span>, color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold.italic"</span>))<span class="op">+</span></span>
<span id="cb83-21"><a href="#cb83-21"></a>        theme(plot.title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">"bold.italic"</span>,size<span class="op">=</span>rel(<span class="fl">1.5</span>)))</span>
<span id="cb83-22"><a href="#cb83-22"></a>show(p5)</span>
<span id="cb83-23"><a href="#cb83-23"></a><span class="co">#ggsave(plot=p5,"./fig/p5.pdf",width=7,height=7)        </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-72" class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">300</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">1500</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>p_<span class="op">&lt;-</span>grid.arrange(p4,p5,ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="co">#ggsave(plot=p6,"./fig/p6.pdf",width=10,height=12)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-73" class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1"></a><span class="op">%%</span>R <span class="op">-</span>r <span class="dv">200</span> <span class="op">-</span>w <span class="dv">2000</span> <span class="op">-</span>h <span class="dv">3000</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>p6<span class="op">&lt;-</span>grid.arrange(p1,p_,nrow<span class="op">=</span><span class="dv">2</span>,heights<span class="op">=</span>c(<span class="dv">3</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="miruetoto/yechan3" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>